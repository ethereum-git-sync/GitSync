{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/1149",
  "id": 453787088,
  "node_id": "MDU6SXNzdWU0NTM3ODcwODg=",
  "number": 1149,
  "title": "Handle endianess in client implementation",
  "user": {
    "login": "dangerousfood",
    "id": 4099038,
    "node_id": "MDQ6VXNlcjQwOTkwMzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dangerousfood",
    "html_url": "https://github.com/dangerousfood",
    "followers_url": "https://api.github.com/users/dangerousfood/followers",
    "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
    "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
    "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
    "repos_url": "https://api.github.com/users/dangerousfood/repos",
    "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1324892187,
      "node_id": "MDU6TGFiZWwxMzI0ODkyMTg3",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/scope:deposit%20contract",
      "name": "scope:deposit contract",
      "color": "005CAF",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-02-18T01:06:14Z",
  "updated_at": "2019-06-09T20:17:24Z",
  "closed_at": "2019-06-09T20:17:24Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "This design seems like it would have a high gas cost. An alternative might be to expect the client implementers to provide little endian values for the contract.\r\n\r\nhttps://github.com/ethereum/deposit_contract/blob/a251fa8bf27f2b0ac74182db98bc311046b08d54/deposit_contract/contracts/validator_registration.v.py#L28-L44",
  "closed_by": {
    "login": "JustinDrake",
    "id": 731743,
    "node_id": "MDQ6VXNlcjczMTc0Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JustinDrake",
    "html_url": "https://github.com/JustinDrake",
    "followers_url": "https://api.github.com/users/JustinDrake/followers",
    "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
    "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
    "repos_url": "https://api.github.com/users/JustinDrake/repos",
    "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/464542465",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-464542465",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 464542465,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDU0MjQ2NQ==",
    "user": {
      "login": "dangerousfood",
      "id": 4099038,
      "node_id": "MDQ6VXNlcjQwOTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dangerousfood",
      "html_url": "https://github.com/dangerousfood",
      "followers_url": "https://api.github.com/users/dangerousfood/followers",
      "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
      "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
      "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
      "repos_url": "https://api.github.com/users/dangerousfood/repos",
      "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-18T01:19:03Z",
    "updated_at": "2019-02-18T01:19:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Another alternative would be to make this function pure and then have the clients call `to_little_endian_64` before sending the `deposit` transaction.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/464542465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465114564",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-465114564",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 465114564,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTExNDU2NA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-19T12:44:21Z",
    "updated_at": "2019-02-19T12:44:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dangerousfood  Endianess of the deposit data is not an issue because it isnt processed by the contract, it is simply appended with the `deposit_amount` and `timestamp` and then logged out in the deposit log. \r\n\r\nIt does become an issue though when processing the logs from the contract where all the integers are by default big endian, so if we dont handle endianess in the contract, we would have to handle it on the client's end. Its trivial for a client to handle the endianess . \r\n\r\nAgree on not handling it in the contract , if we want to optimize for gas efficiency we shouldn't be converting byte arrays in the contract. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465114564/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465275970",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-465275970",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 465275970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTI3NTk3MA==",
    "user": {
      "login": "dangerousfood",
      "id": 4099038,
      "node_id": "MDQ6VXNlcjQwOTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dangerousfood",
      "html_url": "https://github.com/dangerousfood",
      "followers_url": "https://api.github.com/users/dangerousfood/followers",
      "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
      "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
      "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
      "repos_url": "https://api.github.com/users/dangerousfood/repos",
      "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-19T19:28:20Z",
    "updated_at": "2019-02-19T19:29:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Agree on not handling it in the contract , if we want to optimize for gas efficiency we shouldn't be converting byte arrays in the contract.\r\n\r\nSo would you agree on my second approach? The clients calling `to_little_endian_64` locally and providing little endian values to the `deposit` transaction. And the `deposit` method expecting little endian values rather than expending gas for the invocation of `to_little_endian_64`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465275970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465299863",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-465299863",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 465299863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTI5OTg2Mw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-19T20:37:01Z",
    "updated_at": "2019-02-19T20:37:01Z",
    "author_association": "MEMBER",
    "body": "we are only calling `to_little_endian_64` on two values -- the sent eth amount and the timestamp. Both of these can't be trustlessly sent as little endian data in the tx. The only two paths are to convert inside the contract or convert on the 2.0 client side",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465299863/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465412904",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-465412904",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 465412904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTQxMjkwNA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-20T04:00:18Z",
    "updated_at": "2019-02-20T04:00:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dangerousfood Wouldn't the `deposit_data` be little endian by default ? We would serialize this container using SSZ, ex: \r\n```\r\n{\r\n    # BLS pubkey\r\n    'pubkey': 'bytes48',\r\n    # Withdrawal credentials\r\n    'withdrawal_credentials': 'bytes32',\r\n    # A BLS signature of this `DepositInput`\r\n    'proof_of_possession': 'bytes96',\r\n}\r\n```\r\nsince the spec for ssz uses little-endian we wouldn't need to change anything.\r\n\r\nDeposit Flow \r\n\r\n1) Create deposit data using `pubkey`,`withrawal_credentials` and `proof_of_possession` of the validator. \r\n2) Serialize this using SSZ. \r\n3) Send a deposit to the contract with the serialized data.\r\n4) The serialized data, along with the timestamp and deposit amount is then logged by the contract.\r\n5) The client then processes these logs.\r\n\r\nIn my opinion, where clients would have to handle endianess on would be at step 5. Like @djrtwo said,the only two paths to convert would be in the contract or on the client's end. If we are optimizing it for gas efficiency then it should be handled on the client-side. We don't need to call `to_little_endian_64` locally, since most languages have native libraries which handle conversion from little-endian to big-endian and vice versa",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465412904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465618813",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-465618813",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 465618813,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTYxODgxMw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-20T15:13:05Z",
    "updated_at": "2019-02-20T15:13:05Z",
    "author_association": "MEMBER",
    "body": "I imagine calling `to_little_endian_64` twice is a small percentage of the overall gas cost of calling `deposit` and that it is worth keeping within the contract for cleanliness of handling the incoming deposit object in the 2.0 client.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/465618813/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/500241793",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1149#issuecomment-500241793",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1149",
    "id": 500241793,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMDI0MTc5Mw==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-09T20:17:24Z",
    "updated_at": "2019-06-09T20:17:24Z",
    "author_association": "MEMBER",
    "body": "Calling `to_little_endian_64` on `deposit_amount` is not optional because we are calculating the `hash_tree_root` of a `DepositData` object. (Separate from this issue we may change to big-endianâ€”see #1046.)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/500241793/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
