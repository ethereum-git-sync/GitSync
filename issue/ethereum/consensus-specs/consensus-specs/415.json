{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/415",
  "id": 397292063,
  "node_id": "MDU6SXNzdWUzOTcyOTIwNjM=",
  "number": 415,
  "title": "Conditional in Casper / Proposer Processing Never Triggered",
  "user": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-01-09T09:55:16Z",
  "updated_at": "2019-01-10T10:07:54Z",
  "closed_at": "2019-01-10T10:07:54Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Hi all,\r\n\r\nLooking at the following lines in proposer and casper slashings in block operations:\r\n\r\n```\r\nVerify that validator.penalized_slot > state.slot\r\n```\r\n\r\nand\r\n```\r\nFor each validator index i in intersection run penalize_validator(state, i) if state.validator_registry[i].penalized_slot > state.slot\r\n```\r\n\r\n`validator.penalized_slot` is only updated in the `penalize_validator` function, but this function is only used in the spec if the previous conditional passes. The code above will never run as `penalized_slot` will always be the default value of `FAR_FUTURE_SLOT`. Am I missing something?",
  "closed_by": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452952591",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/415#issuecomment-452952591",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415",
    "id": 452952591,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Mjk1MjU5MQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T02:58:16Z",
    "updated_at": "2019-01-10T02:58:16Z",
    "author_association": "MEMBER",
    "body": "The following line ensures that the validator has not yet been penalized. If the validator _has_ been penalized by another operation, then the `penalized_slot` will be `<= state.slot` because it either happened at this slot or in the past. If the validator _has not_ been penalized already, then their `penalized_slot` will be `== FAR_FUTURE_SLOT` and certainly greater than `state.slot`\r\n```\r\nVerify that validator.penalized_slot > state.slot\r\n```\r\n\r\nThe following line is a similar catch to prevent double penalization in attestations. It runs penalization for the set of slashable validators that have not yet been penalized. Some  validators might have been slashed via some other message so this ensures that we don't overwrite a previously set `penalized_slot`\r\n```\r\nFor each validator index i in intersection run penalize_validator(state, i) if state.validator_registry[i].penalized_slot > state.slot\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452952591/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452952675",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/415#issuecomment-452952675",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415",
    "id": 452952675,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Mjk1MjY3NQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T02:58:50Z",
    "updated_at": "2019-01-10T02:58:50Z",
    "author_association": "MEMBER",
    "body": "I'm pretty sure these conditions are correct as is. Does that make sense? Am I missing something?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452952675/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452956496",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/415#issuecomment-452956496",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/415",
    "id": 452956496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Mjk1NjQ5Ng==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T03:20:42Z",
    "updated_at": "2019-01-10T03:20:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey Danny this makes sense - it serves as protection against other operations or functions mutating that field and causing an inconsistent condition. To add to my confusion, we had not yet updated our beacon config so the default penalized slot in Prysm was 0 instead of FAR_FUTURE_SLOT, which I think was the root of my problem.\n\nThis issue can be closed, thank you!\n\nOn Thu, Jan 10 2019 at 10:58 AM, < notifications@github.com > wrote:\n\n> \n> \n> \n> I'm pretty sure these conditions are correct as is. Does that make sense?\n> Am I missing something?\n> \n> \n> \n> â€”\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub (\n> https://github.com/ethereum/eth2.0-specs/issues/415#issuecomment-452952675\n> ) , or mute the thread (\n> https://github.com/notifications/unsubscribe-auth/AFUIPXfrgkX9AXUtI0WHzc6y1OC3i4Bhks5vBqxrgaJpZM4Z3IcW\n> ).\n> \n> \n>",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/452956496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
