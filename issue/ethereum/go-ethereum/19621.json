{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19621",
  "id": 448041799,
  "node_id": "MDU6SXNzdWU0NDgwNDE3OTk=",
  "number": 19621,
  "title": "Different block hash on PoA networks when there are multiple miners",
  "user": {
    "login": "kigawas",
    "id": 4182346,
    "node_id": "MDQ6VXNlcjQxODIzNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4182346?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kigawas",
    "html_url": "https://github.com/kigawas",
    "followers_url": "https://api.github.com/users/kigawas/followers",
    "following_url": "https://api.github.com/users/kigawas/following{/other_user}",
    "gists_url": "https://api.github.com/users/kigawas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kigawas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kigawas/subscriptions",
    "organizations_url": "https://api.github.com/users/kigawas/orgs",
    "repos_url": "https://api.github.com/users/kigawas/repos",
    "events_url": "https://api.github.com/users/kigawas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kigawas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1269332912,
      "node_id": "MDU6TGFiZWwxMjY5MzMyOTEy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:clique",
      "name": "area:clique",
      "color": "e590e1",
      "default": false,
      "description": ""
    },
    {
      "id": 1380056442,
      "node_id": "MDU6TGFiZWwxMzgwMDU2NDQy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:mining",
      "name": "area:mining",
      "color": "ca4ff7",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-05-24T08:26:14Z",
  "updated_at": "2020-08-27T08:59:25Z",
  "closed_at": "2019-06-04T08:59:36Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Say you have a private PoA network deployed on kubernetes\r\n1. There are 3 miners and 2 non mining nodes\r\n2. 3 miners started with one signer address defined in `genesis.json`\r\n3. Kubernetes will start the nodes almost simultaneously\r\n4. When mining, there come concurrent blocks and different blockchains\r\n\r\n#### System information\r\n\r\nGeth version: `Geth/v1.8.27-stable-4bcc0a37/linux-amd64/go1.11.9`\r\nOS & Version: Windows/Linux/OSX\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nAll nodes should share the same blockchain\r\n\r\n#### Actual behaviour\r\nSome miner nodes have different blockchain\r\n\r\n#### Steps to reproduce the behaviour\r\n1. Deploy a PoA network on kubernetes via helm. The official helm chart is based on PoW but I forked and updated the configuration to PoA at [here](https://github.com/kigawas/charts/tree/master/stable/ethereum)\r\n\r\n2. After everything running up, check the ethstats page like:\r\n\r\n![Screenshot from 2019-05-24 17-17-53](https://user-images.githubusercontent.com/4182346/58313204-f8980180-7e47-11e9-82c3-e967826e931d.png)\r\n\r\n3. You can find some miner's block has some different hashes\r\n\r\n#### Backtrace\r\nNot apply\r\n\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/495645705",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19621#issuecomment-495645705",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621",
    "id": 495645705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NTY0NTcwNQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-24T14:09:07Z",
    "updated_at": "2019-05-24T14:09:07Z",
    "author_association": "MEMBER",
    "body": "Are you using the same address for multiple miners? If yes, that's a bad idea, because they will race for each other, and every block will have the same weights. In Clique, all signers are meant to have their own keys.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/495645705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/496045058",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19621#issuecomment-496045058",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621",
    "id": 496045058,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjA0NTA1OA==",
    "user": {
      "login": "kigawas",
      "id": 4182346,
      "node_id": "MDQ6VXNlcjQxODIzNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4182346?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kigawas",
      "html_url": "https://github.com/kigawas",
      "followers_url": "https://api.github.com/users/kigawas/followers",
      "following_url": "https://api.github.com/users/kigawas/following{/other_user}",
      "gists_url": "https://api.github.com/users/kigawas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kigawas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kigawas/subscriptions",
      "organizations_url": "https://api.github.com/users/kigawas/orgs",
      "repos_url": "https://api.github.com/users/kigawas/repos",
      "events_url": "https://api.github.com/users/kigawas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kigawas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-27T00:42:09Z",
    "updated_at": "2019-05-27T00:42:09Z",
    "author_association": "NONE",
    "body": "Thanks for your reply. If multiple miners on same address will race, what about two addresses?\r\n\r\nCorrect me if I'm wrong, I couldn't see difference between 2 miners on 1 address and 2 miners on 2 addresses",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/496045058/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/498585782",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19621#issuecomment-498585782",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19621",
    "id": 498585782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODU4NTc4Mg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-04T08:59:36Z",
    "updated_at": "2019-06-04T08:59:36Z",
    "author_association": "MEMBER",
    "body": "In Clique PoA, block difficulties depend on mining order. If you have a single authorized signer, all blocks will have the exact same difficulty. However if you are mining with multiple instances of the same signer, you will have competing chains with the exact same difficulty, so the network will have a very hard time to pick one from the many competing chains.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/498585782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
