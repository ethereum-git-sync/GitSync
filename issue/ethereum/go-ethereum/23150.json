{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23150",
  "id": 935398477,
  "node_id": "MDU6SXNzdWU5MzUzOTg0Nzc=",
  "number": 23150,
  "title": "RPC method eth_createAccessList crashed",
  "user": {
    "login": "pinkiebell",
    "id": 40266861,
    "node_id": "MDQ6VXNlcjQwMjY2ODYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/40266861?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pinkiebell",
    "html_url": "https://github.com/pinkiebell",
    "followers_url": "https://api.github.com/users/pinkiebell/followers",
    "following_url": "https://api.github.com/users/pinkiebell/following{/other_user}",
    "gists_url": "https://api.github.com/users/pinkiebell/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pinkiebell/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pinkiebell/subscriptions",
    "organizations_url": "https://api.github.com/users/pinkiebell/orgs",
    "repos_url": "https://api.github.com/users/pinkiebell/repos",
    "events_url": "https://api.github.com/users/pinkiebell/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pinkiebell/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-07-02T04:20:55Z",
  "updated_at": "2021-07-06T17:09:52Z",
  "closed_at": "2021-07-06T17:09:48Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `v1.10.4`\r\nOS & Version: Linux\r\nCommit hash : (if `develop`)\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n1. Clone https://github.com/NutBerry/NutBerry\r\n2. Activate london:\r\n```\r\ndiff --git a/scripts/genesis.json b/scripts/genesis.json\r\nindex 7216652..0751595 100644\r\n--- a/scripts/genesis.json\r\n+++ b/scripts/genesis.json\r\n@@ -12,6 +12,7 @@\r\n     \"istanbulBlock\": 0,\r\n     \"muirGlacierBlock\": 0,\r\n     \"berlinBlock\": 0,\r\n+    \"londonBlock\": 0,\r\n     \"clique\": {\r\n       \"period\": 0,\r\n       \"epoch\": 30000\r\n```\r\n3. bootstrap\r\n`docker-compose up --no-deps dev`\r\n4. Enter dev env\r\n`./scripts/dev.sh`\r\n5. Run the test directly where the issue happes\r\n`yarn _test src/v1/test/bench.test.js`\r\nwatch geth at the same time:\r\n`docker-compose logs -f --tail 100 geth`\r\n\r\n#### Backtrace\r\n\r\n````\r\ngeth_1  | INFO [07-02|04:09:20.129] Commit new mining work                   number=154 sealhash=7d8579..ef9b54 uncles=0 txs=0 gas=0         fees=0               elapsed=3.766ms\r\ngeth_1  | INFO [07-02|04:09:20.131] Sealing paused, waiting for transactions \r\ngeth_1  | ERROR[07-02|04:09:20.265] RPC method eth_createAccessList crashed: runtime error: invalid memory address or nil pointer dereference\r\ngeth_1  | goroutine 15581 [running]:\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*callback).call.func1(0xc0065ef0e0, 0x14, 0xc000233d58)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/service.go:200 +0xbd\r\ngeth_1  | panic(0x11e17a0, 0x1c3f060)\r\ngeth_1  | \truntime/panic.go:965 +0x1b9\r\ngeth_1  | math/big.(*Int).BitLen(...)\r\ngeth_1  | \tmath/big/int.go:473\r\ngeth_1  | github.com/ethereum/go-ethereum/core.(*StateTransition).preCheck(0xc00383db80, 0x0, 0x0)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/core/state_transition.go:226 +0xed\r\ngeth_1  | github.com/ethereum/go-ethereum/core.(*StateTransition).TransitionDb(0xc00383db80, 0x15aa5e0, 0xc006495170, 0xc003b988f8)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/core/state_transition.go:274 +0x45\r\ngeth_1  | github.com/ethereum/go-ethereum/core.ApplyMessage(0xc003a58a80, 0x15aa5e0, 0xc006495170, 0xc003b988f8, 0xc0064950e0, 0xc00397d860, 0xc007fa9680)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/core/state_transition.go:178 +0x57\r\ngeth_1  | github.com/ethereum/go-ethereum/internal/ethapi.AccessList(0x159bab8, 0xc0014bd840, 0x15b5038, 0xc000541170, 0xc003b98878, 0x0, 0x1218400, 0xc0065ef0f8, 0xc0065ef110, 0xc003b98850, ...)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/internal/ethapi/api.go:1395 +0x9ef\r\ngeth_1  | github.com/ethereum/go-ethereum/internal/ethapi.(*PublicBlockChainAPI).CreateAccessList(0xc000161430, 0x159bab8, 0xc0014bd840, 0xc0065ef0f8, 0xc0065ef110, 0xc003b98850, 0xc004d73e00, 0x0, 0x0, 0x0, ...)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/internal/ethapi/api.go:1328 +0x138\r\ngeth_1  | reflect.Value.call(0xc00024d300, 0xc0009961f0, 0x13, 0x1368d34, 0x4, 0xc003d00d20, 0x4, 0x4, 0xc003d00d50, 0xc004a026f0, ...)\r\ngeth_1  | \treflect/value.go:476 +0x8e7\r\ngeth_1  | reflect.Value.Call(0xc00024d300, 0xc0009961f0, 0x13, 0xc003d00d20, 0x4, 0x4, 0x0, 0x0, 0xc0014bd880)\r\ngeth_1  | \treflect/value.go:337 +0xb9\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*callback).call(0xc00099c7e0, 0x159bab8, 0xc0014bd840, 0xc0065ef0e0, 0x14, 0xc004a026f0, 0x2, 0x2, 0x0, 0x0, ...)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/service.go:206 +0x2c5\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*handler).runMethod(0xc006494fc0, 0x159bab8, 0xc0014bd840, 0xc002a21730, 0xc00099c7e0, 0xc004a026f0, 0x2, 0x2, 0x2)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:389 +0x8a\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*handler).handleCall(0xc006494fc0, 0xc004a02690, 0xc002a21730, 0x203001)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:337 +0x265\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*handler).handleCallMsg(0xc006494fc0, 0xc004a02690, 0xc002a21730, 0x158db01)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:298 +0x1be\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*handler).handleMsg.func1(0xc004a02690)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:139 +0x46\r\ngeth_1  | github.com/ethereum/go-ethereum/rpc.(*handler).startCallProc.func1(0xc006494fc0, 0xc00372f458)\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:226 +0xd2\r\ngeth_1  | created by github.com/ethereum/go-ethereum/rpc.(*handler).startCallProc\r\ngeth_1  | \tgithub.com/ethereum/go-ethereum/rpc/handler.go:222 +0x66\r\ngeth_1  |  \r\ngeth_1  | WARN [07-02|04:09:20.265] Served eth_createAccessList              conn=192.168.112.3:52722 reqid=1 t=\"764.902ï¿½ï¿½s\" err=\"method handler crashed\"\r\n\r\n````\r\n\r\n### Notes\r\n\r\nThis does only happen if the london fork block is activated.",
  "closed_by": {
    "login": "pinkiebell",
    "id": 40266861,
    "node_id": "MDQ6VXNlcjQwMjY2ODYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/40266861?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pinkiebell",
    "html_url": "https://github.com/pinkiebell",
    "followers_url": "https://api.github.com/users/pinkiebell/followers",
    "following_url": "https://api.github.com/users/pinkiebell/following{/other_user}",
    "gists_url": "https://api.github.com/users/pinkiebell/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pinkiebell/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pinkiebell/subscriptions",
    "organizations_url": "https://api.github.com/users/pinkiebell/orgs",
    "repos_url": "https://api.github.com/users/pinkiebell/repos",
    "events_url": "https://api.github.com/users/pinkiebell/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pinkiebell/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874611270",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23150#issuecomment-874611270",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150",
    "id": 874611270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDYxMTI3MA==",
    "user": {
      "login": "gballet",
      "id": 3272758,
      "node_id": "MDQ6VXNlcjMyNzI3NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3272758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gballet",
      "html_url": "https://github.com/gballet",
      "followers_url": "https://api.github.com/users/gballet/followers",
      "following_url": "https://api.github.com/users/gballet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gballet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gballet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gballet/subscriptions",
      "organizations_url": "https://api.github.com/users/gballet/orgs",
      "repos_url": "https://api.github.com/users/gballet/repos",
      "events_url": "https://api.github.com/users/gballet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gballet/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T09:33:08Z",
    "updated_at": "2021-07-06T09:33:39Z",
    "author_association": "MEMBER",
    "body": "@jwasinger is going to have a look at this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874611270/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874612645",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23150#issuecomment-874612645",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150",
    "id": 874612645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDYxMjY0NQ==",
    "user": {
      "login": "gballet",
      "id": 3272758,
      "node_id": "MDQ6VXNlcjMyNzI3NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3272758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gballet",
      "html_url": "https://github.com/gballet",
      "followers_url": "https://api.github.com/users/gballet/followers",
      "following_url": "https://api.github.com/users/gballet/following{/other_user}",
      "gists_url": "https://api.github.com/users/gballet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gballet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gballet/subscriptions",
      "organizations_url": "https://api.github.com/users/gballet/orgs",
      "repos_url": "https://api.github.com/users/gballet/repos",
      "events_url": "https://api.github.com/users/gballet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gballet/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T09:35:19Z",
    "updated_at": "2021-07-06T09:35:19Z",
    "author_association": "MEMBER",
    "body": "@pinkiebell what was the RPC command that you sent?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874612645/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874648663",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23150#issuecomment-874648663",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150",
    "id": 874648663,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDY0ODY2Mw==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T10:32:55Z",
    "updated_at": "2021-07-06T10:32:55Z",
    "author_association": "MEMBER",
    "body": "This should already be fixed by https://github.com/ethereum/go-ethereum/pull/23133",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874648663/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874935903",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23150#issuecomment-874935903",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23150",
    "id": 874935903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDkzNTkwMw==",
    "user": {
      "login": "pinkiebell",
      "id": 40266861,
      "node_id": "MDQ6VXNlcjQwMjY2ODYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/40266861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pinkiebell",
      "html_url": "https://github.com/pinkiebell",
      "followers_url": "https://api.github.com/users/pinkiebell/followers",
      "following_url": "https://api.github.com/users/pinkiebell/following{/other_user}",
      "gists_url": "https://api.github.com/users/pinkiebell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pinkiebell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pinkiebell/subscriptions",
      "organizations_url": "https://api.github.com/users/pinkiebell/orgs",
      "repos_url": "https://api.github.com/users/pinkiebell/repos",
      "events_url": "https://api.github.com/users/pinkiebell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pinkiebell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T17:09:48Z",
    "updated_at": "2021-07-06T17:09:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Crash doesn't happen anymore with latest build @ d21a0696197cd87165aed2d7bc5b8bf965580f91 ðŸ™Œ ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/874935903/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
