{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23583",
  "id": 997713266,
  "node_id": "I_kwDOAOvK9847d-Vy",
  "number": 23583,
  "title": "Node use the Intranet IP addresses linked together",
  "user": {
    "login": "kaolula",
    "id": 11549225,
    "node_id": "MDQ6VXNlcjExNTQ5MjI1",
    "avatar_url": "https://avatars.githubusercontent.com/u/11549225?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kaolula",
    "html_url": "https://github.com/kaolula",
    "followers_url": "https://api.github.com/users/kaolula/followers",
    "following_url": "https://api.github.com/users/kaolula/following{/other_user}",
    "gists_url": "https://api.github.com/users/kaolula/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kaolula/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kaolula/subscriptions",
    "organizations_url": "https://api.github.com/users/kaolula/orgs",
    "repos_url": "https://api.github.com/users/kaolula/repos",
    "events_url": "https://api.github.com/users/kaolula/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kaolula/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2021-09-16T03:16:20Z",
  "updated_at": "2021-10-20T07:55:52Z",
  "closed_at": "2021-10-20T07:55:52Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I have five servers synchronizing the mainnet network nodes on AWS,want these five servers to broadcast transactions through the intranet p2p.I see two arguments, but I don't know how to use them\r\n```\r\n  --netrestrict value                 Restricts network communication to the given IP networks (CIDR masks)\r\n  --nat value                         NAT port mapping mechanism (any|none|upnp|pmp|extip:<IP>) (default: \"any\")\r\n```\r\n\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/920675979",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-920675979",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 920675979,
    "node_id": "IC_kwDOAOvK98424GaL",
    "user": {
      "login": "verheesj",
      "id": 3089457,
      "node_id": "MDQ6VXNlcjMwODk0NTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3089457?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/verheesj",
      "html_url": "https://github.com/verheesj",
      "followers_url": "https://api.github.com/users/verheesj/followers",
      "following_url": "https://api.github.com/users/verheesj/following{/other_user}",
      "gists_url": "https://api.github.com/users/verheesj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/verheesj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/verheesj/subscriptions",
      "organizations_url": "https://api.github.com/users/verheesj/orgs",
      "repos_url": "https://api.github.com/users/verheesj/repos",
      "events_url": "https://api.github.com/users/verheesj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/verheesj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-16T07:57:06Z",
    "updated_at": "2021-09-16T07:57:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "First, determine the IP address of the machine your bootstrap node will run on. If you are using a cloud service such as Amazon EC2, you’ll find the IP of the virtual machine in the management console. Please also ensure that your firewall configuration allows both UDP and TCP traffic on port 30303.\r\n\r\nThe bootstrap node needs to know about its own IP address in order to be able to relay it others. The IP is set using the `--nat` flag (insert your own IP instead of the example address below).\r\n\r\n`geth --datadir data --networkid 15 --nat extip:172.16.254.4\r\n`\r\n\r\nNow extract the ‘node record’ of the bootnode using the JS console.\r\n\r\n`geth attach data/geth.ipc --exec admin.nodeInfo.enr\r\n`\r\nThis command should print a base64 string such as the following example. Other nodes will use the information contained in the bootstrap node record to connect to your peer-to-peer network.\r\n\r\n`\"enr:-Je4QEiMeOxy_h0aweL2DtZmxnUMy-XPQcZllrMt_2V1lzynOwSx7GnjCf1k8BAsZD5dvHOBLuldzLYxpoD5UcqISiwDg2V0aMfGhGlQhqmAgmlkgnY0gmlwhKwQ_gSJc2VjcDI1NmsxoQKX_WLWgDKONsGvxtp9OeSIv2fRoGwu5vMtxfNGdut4cIN0Y3CCdl-DdWRwgnZf\"\r\n`\r\n\r\nSetting up peer-to-peer networking depends on your requirements. If you connect nodes across the Internet, please ensure that your bootnode and all other nodes have public IP addresses assigned, and both TCP and UDP traffic can pass the firewall.\r\n\r\nIf Internet connectivity is not required or all member nodes connect using well-known IPs, **we strongly recommend setting up Geth to restrict peer-to-peer connectivity to an IP subnet**. Doing so will further isolate your network and prevents cross-connecting with other blockchain networks in case your nodes are reachable from the Internet. Use the **--netrestrict flag to configure a whitelist of IP networks:**\r\n\r\n`geth <other-flags> --netrestrict 172.16.254.0/24\r\n`\r\nWith the above setting, Geth will only allow connections from the `172.16.254.0/24 `subnet, and will not attempt to connect to other nodes outside of the set IP range.\r\n\r\n### Running Member Nodes\r\n\r\nBefore running a member node, you have to initialize it with the same genesis file as used for the bootstrap node.\r\n\r\nWith the bootnode operational and externally reachable (you can try `telnet <ip> <port>` to ensure it’s indeed reachable), you can start more Geth nodes and connect them via the bootstrap node using the `--bootnodes` flag.\r\n\r\nTo create a member node running on the same machine as the bootstrap node, choose a separate data directory (example: data-2) and listening port (example: 30305):\r\n\r\n`geth --datadir data-2 --networkid 15 --port 30305 --bootnodes <bootstrap-node-record>`\r\n\r\nWith the member node running, you can check whether it is connected to the bootstrap node or any other node in your network by attaching a console and running admin.peers. It may take up to a few seconds for the nodes to get connected.\r\n\r\n`geth attach data-2/geth.ipc --exec admin.peers`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/920675979/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922170771",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922170771",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922170771,
    "node_id": "IC_kwDOAOvK98429zWT",
    "user": {
      "login": "kaolula",
      "id": 11549225,
      "node_id": "MDQ6VXNlcjExNTQ5MjI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11549225?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaolula",
      "html_url": "https://github.com/kaolula",
      "followers_url": "https://api.github.com/users/kaolula/followers",
      "following_url": "https://api.github.com/users/kaolula/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaolula/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaolula/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaolula/subscriptions",
      "organizations_url": "https://api.github.com/users/kaolula/orgs",
      "repos_url": "https://api.github.com/users/kaolula/repos",
      "events_url": "https://api.github.com/users/kaolula/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaolula/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-18T03:24:08Z",
    "updated_at": "2021-09-18T03:24:08Z",
    "author_association": "NONE",
    "body": "I have three Amazon EC2,they are all synchronized with Ethereum node data.\r\nThe machine information\r\n|  Machine Name   | External network ip  | Internal network ip  |\r\n|  ----  | ----  |----  |\r\n| EC2-A  | 70.122.90.94 |192.168.1.1 |\r\n| EC2-B  | 70.122.91.95 |192.168.1.2 |\r\n| EC2-C  | 70.122.92.96|192.168.1.3|\r\n> The i.P. information on the extranet is fake,Just for better description\r\nEC2-A machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:192.168.1.1 --maxpeers 10000 \r\n```\r\nEC2-B machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:192.168.1.2--maxpeers 10000 \r\n```\r\nEC2-C machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:192.168.1.3--maxpeers 10000 \r\n```\r\n\r\n**Information for each node** \r\nEC2-A nodeino\r\n```\r\n  enode: \"enode://f2b359dc15a673145c491474c2e7830fb5a3a5d652c770ab5d8d8ab96c58f483acc8b17e31f33926c77894ee1fc7560d5f6f65c99a75687fd3eb24716f51c2ee@192.168.1.1:30311\",\r\n  enr: \"enr:-J24QLPie002uZ8ootd9oDOkaCGJoEd0eJwNV231Bm3idtM5FFqkTvuJxPxMbeWkv5Je16uV-ZpspB5K1I1-XstE7lUDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoARqJc2VjcDI1NmsxoQLys1ncFaZzFFxJFHTC54MPtaOl1lLHcKtdjYq5bFj0g4RzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n  id: \"b6fe3c28cc6a3eabd9ad5eab9047611faaea3a9650e9a2237b4f654bd89f6d7e\",\r\n  ip: \"192.168.1.1\",\r\n  listenAddr: \"[::]:30311\",\r\n```\r\n\r\nEC2-B nodeino\r\n```\r\n  enode: \"enode://4da3f4aa20ff15276c1faef532cf796f93f10d85164bf4ce16a73c8eaaab96e3d6f6af6581d9cf01410d717b9fd5b22ae4bc81706b53f252006bd9ba19a20567@192.168.1.2:30311\",\r\n  enr: \"enr:-J24QOoMf8CjLdpcBNBbTAqVfNySlXdbXN8An2LikjJPKwDMfiSnVP1flxDc3jLnhI8DRb_TG_CUNn2ucr0IFdeZn3sDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoAR6Jc2VjcDI1NmsxoQNNo_SqIP8VJ2wfrvUyz3lvk_ENhRZL9M4WpzyOqquW44RzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n  id: \"8b87239184918b94013e32cb43b86a0458a4b7f3df8516af56629112fa48797e\",\r\n  ip: \"192.168.1.2\",\r\n  listenAddr: \"[::]:30311\",\r\n```\r\n\r\n\r\nEC2-C nodeino\r\n```\r\n  enode: \"enode://c86df17a43d969edd5c72d6709cbbd8af04899fc7da5ecd97dc7f9863be2edc6c3d32a0c14d1451114b3d328b3d11c9836ec136e9a32e08e00f4f38d09b6e03f@192.168.1.3:30311\",\r\n  enr: \"enr:-J24QGn4cFBGMiTFjZlls83jCGz0woy1XU9DCgX9uZ292SqSU59gjd-W8ZUlYRTkIGxMiqqm8WNrpuxI_z64Od1BNhMDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoAQiJc2VjcDI1NmsxoQPIbfF6Q9lp7dXHLWcJy72K8EiZ_H2l7Nl9x_mGO-LtxoRzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n  id: \"073e9fe8072d90178f347a95bb65176ec017a9a6d6bc9af113afde480d118560\",\r\n  ip: \"192.168.1.3\",\r\n  listenAddr: \"[::]:30311\",\r\n```\r\n![image](https://user-images.githubusercontent.com/11549225/133870947-1c6fcd8d-ff77-420c-bb5f-950a79f602d9.png)\r\nThese three machines can broadcast transactions on the intranet machine p2p.But I found that the node identity is the intranet ip, will this prevent other machines from connecting to our machine?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922170771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922340721",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922340721",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922340721,
    "node_id": "IC_kwDOAOvK9842-c1x",
    "user": {
      "login": "verheesj",
      "id": 3089457,
      "node_id": "MDQ6VXNlcjMwODk0NTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3089457?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/verheesj",
      "html_url": "https://github.com/verheesj",
      "followers_url": "https://api.github.com/users/verheesj/followers",
      "following_url": "https://api.github.com/users/verheesj/following{/other_user}",
      "gists_url": "https://api.github.com/users/verheesj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/verheesj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/verheesj/subscriptions",
      "organizations_url": "https://api.github.com/users/verheesj/orgs",
      "repos_url": "https://api.github.com/users/verheesj/repos",
      "events_url": "https://api.github.com/users/verheesj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/verheesj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-18T17:07:00Z",
    "updated_at": "2021-09-18T17:07:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I have three Amazon EC2,they are all synchronized with Ethereum node data.\r\n> The machine information\r\n> Machine Name \tExternal network ip \tInternal network ip\r\n> EC2-A \t70.122.90.94 \t192.168.1.1\r\n> EC2-B \t70.122.91.95 \t192.168.1.2\r\n> EC2-C \t70.122.92.96 \t192.168.1.3\r\n> \r\n> > The i.P. information on the extranet is fake,Just for better description\r\n> > EC2-A machine start script\r\n> \r\n> ```\r\n> ./geth --config ./config.toml --nat=extip:192.168.1.1 --maxpeers 10000 \r\n> ```\r\n> \r\n> EC2-B machine start script\r\n> \r\n> ```\r\n> ./geth --config ./config.toml --nat=extip:192.168.1.2--maxpeers 10000 \r\n> ```\r\n> \r\n> EC2-C machine start script\r\n> \r\n> ```\r\n> ./geth --config ./config.toml --nat=extip:192.168.1.3--maxpeers 10000 \r\n> ```\r\n> \r\n> **Information for each node**\r\n> EC2-A nodeino\r\n> \r\n> ```\r\n>   enode: \"enode://f2b359dc15a673145c491474c2e7830fb5a3a5d652c770ab5d8d8ab96c58f483acc8b17e31f33926c77894ee1fc7560d5f6f65c99a75687fd3eb24716f51c2ee@192.168.1.1:30311\",\r\n>   enr: \"enr:-J24QLPie002uZ8ootd9oDOkaCGJoEd0eJwNV231Bm3idtM5FFqkTvuJxPxMbeWkv5Je16uV-ZpspB5K1I1-XstE7lUDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoARqJc2VjcDI1NmsxoQLys1ncFaZzFFxJFHTC54MPtaOl1lLHcKtdjYq5bFj0g4RzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n>   id: \"b6fe3c28cc6a3eabd9ad5eab9047611faaea3a9650e9a2237b4f654bd89f6d7e\",\r\n>   ip: \"192.168.1.1\",\r\n>   listenAddr: \"[::]:30311\",\r\n> ```\r\n> \r\n> EC2-B nodeino\r\n> \r\n> ```\r\n>   enode: \"enode://4da3f4aa20ff15276c1faef532cf796f93f10d85164bf4ce16a73c8eaaab96e3d6f6af6581d9cf01410d717b9fd5b22ae4bc81706b53f252006bd9ba19a20567@192.168.1.2:30311\",\r\n>   enr: \"enr:-J24QOoMf8CjLdpcBNBbTAqVfNySlXdbXN8An2LikjJPKwDMfiSnVP1flxDc3jLnhI8DRb_TG_CUNn2ucr0IFdeZn3sDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoAR6Jc2VjcDI1NmsxoQNNo_SqIP8VJ2wfrvUyz3lvk_ENhRZL9M4WpzyOqquW44RzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n>   id: \"8b87239184918b94013e32cb43b86a0458a4b7f3df8516af56629112fa48797e\",\r\n>   ip: \"192.168.1.2\",\r\n>   listenAddr: \"[::]:30311\",\r\n> ```\r\n> \r\n> EC2-C nodeino\r\n> \r\n> ```\r\n>   enode: \"enode://c86df17a43d969edd5c72d6709cbbd8af04899fc7da5ecd97dc7f9863be2edc6c3d32a0c14d1451114b3d328b3d11c9836ec136e9a32e08e00f4f38d09b6e03f@192.168.1.3:30311\",\r\n>   enr: \"enr:-J24QGn4cFBGMiTFjZlls83jCGz0woy1XU9DCgX9uZ292SqSU59gjd-W8ZUlYRTkIGxMiqqm8WNrpuxI_z64Od1BNhMDg2V0aMfGhPw8preAgmlkgnY0gmlwhMCoAQiJc2VjcDI1NmsxoQPIbfF6Q9lp7dXHLWcJy72K8EiZ_H2l7Nl9x_mGO-LtxoRzbmFwwIN0Y3CCdmeDdWRwgnZn\",\r\n>   id: \"073e9fe8072d90178f347a95bb65176ec017a9a6d6bc9af113afde480d118560\",\r\n>   ip: \"192.168.1.3\",\r\n>   listenAddr: \"[::]:30311\",\r\n> ```\r\n> \r\n> ![image](https://user-images.githubusercontent.com/11549225/133870947-1c6fcd8d-ff77-420c-bb5f-950a79f602d9.png)\r\n> These three machines can broadcast transactions on the intranet machine p2p.But I found that the node identity is the intranet ip, will this prevent other machines from connecting to our machine?\r\n\r\nSetting up peer-to-peer networking depends on your requirements. If you connect nodes across the Internet, please ensure that your bootnode and all other nodes have public IP addresses assigned, and both TCP and UDP traffic can pass the firewall.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922340721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922737802",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922737802",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922737802,
    "node_id": "IC_kwDOAOvK9842_9yK",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T08:47:26Z",
    "updated_at": "2021-09-20T08:47:26Z",
    "author_association": "MEMBER",
    "body": "> ./geth --config ./config.toml --nat=extip:192.168.1.3--maxpeers 10000 \r\n\r\nThis is wrong -- you're telling geth to use the internal IP as the external IP. You should insted use `--nat=extip:70.122.92.96`. \r\n\r\nAnd to answer this question: \r\n\r\n> But I found that the node identity is the intranet ip, will this prevent other machines from connecting to our machine?\r\n\r\nYes (but no). So yes, it will prevent incoming connections, which accounts for up to half the peer slots. However, the other half is outgoing connections, which will still work. So your nodes will still be able to connect to external peers (but only those that have a public ip address.)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922737802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922743158",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922743158",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922743158,
    "node_id": "IC_kwDOAOvK9842__F2",
    "user": {
      "login": "kaolula",
      "id": 11549225,
      "node_id": "MDQ6VXNlcjExNTQ5MjI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11549225?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaolula",
      "html_url": "https://github.com/kaolula",
      "followers_url": "https://api.github.com/users/kaolula/followers",
      "following_url": "https://api.github.com/users/kaolula/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaolula/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaolula/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaolula/subscriptions",
      "organizations_url": "https://api.github.com/users/kaolula/orgs",
      "repos_url": "https://api.github.com/users/kaolula/repos",
      "events_url": "https://api.github.com/users/kaolula/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaolula/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T08:56:33Z",
    "updated_at": "2021-09-20T08:56:33Z",
    "author_association": "NONE",
    "body": "> > ./geth --config ./config.toml --nat=extip:192.168.1.3--maxpeers 10000\r\n> \r\n> This is wrong -- you're telling geth to use the internal IP as the external IP. You should insted use `--nat=extip:70.122.92.96`.\r\n> \r\n> And to answer this question:\r\n> \r\n> > But I found that the node identity is the intranet ip, will this prevent other machines from connecting to our machine?\r\n> \r\n> Yes (but no). So yes, it will prevent incoming connections, which accounts for up to half the peer slots. However, the other half is outgoing connections, which will still work. So your nodes will still be able to connect to external peers (but only those that have a public ip address.)\r\n\r\nIf i set --nat use external Ip,\r\nfor example:\r\nEC2-A machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:70.122.90.94 --maxpeers 10000 \r\n```\r\nEC2-B machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:70.122.90.95 --maxpeers 10000 \r\n```\r\nEC2-C machine start script\r\n```\r\n./geth --config ./config.toml --nat=extip:70.122.90.96 --maxpeers 10000 \r\n```\r\nThen these three machines all use the public network for p2p broadcast transactions, right?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922743158/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922747992",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922747992",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922747992,
    "node_id": "IC_kwDOAOvK9843AARY",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T09:03:47Z",
    "updated_at": "2021-09-20T09:03:47Z",
    "author_association": "MEMBER",
    "body": "> Then these three machines all use the public network for p2p broadcast transactions, right?\r\n\r\nThey will alwys do that, regardless fo what you set extip to. Whether or not to connect to mainnet peers or not can be influenced by netrestrict (prevent peering outside your bubble) or `--networkid` (connect only to peers on your specific ethereum network id)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922747992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922749953",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-922749953",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 922749953,
    "node_id": "IC_kwDOAOvK9843AAwB",
    "user": {
      "login": "kaolula",
      "id": 11549225,
      "node_id": "MDQ6VXNlcjExNTQ5MjI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11549225?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaolula",
      "html_url": "https://github.com/kaolula",
      "followers_url": "https://api.github.com/users/kaolula/followers",
      "following_url": "https://api.github.com/users/kaolula/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaolula/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaolula/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaolula/subscriptions",
      "organizations_url": "https://api.github.com/users/kaolula/orgs",
      "repos_url": "https://api.github.com/users/kaolula/repos",
      "events_url": "https://api.github.com/users/kaolula/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaolula/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T09:06:23Z",
    "updated_at": "2021-09-20T09:06:23Z",
    "author_association": "NONE",
    "body": "> > Then these three machines all use the public network for p2p broadcast transactions, right?\r\n> \r\n> They will alwys do that, regardless fo what you set extip to. Whether or not to connect to mainnet peers or not can be influenced by netrestrict (prevent peering outside your bubble) or `--networkid` (connect only to peers on your specific ethereum network id)\r\n\r\nOk,Thank you very much for your answer",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/922749953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/947419535",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23583#issuecomment-947419535",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23583",
    "id": 947419535,
    "node_id": "IC_kwDOAOvK9844eHmP",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T07:55:52Z",
    "updated_at": "2021-10-20T07:55:52Z",
    "author_association": "MEMBER",
    "body": "Seems resolved, closing this",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/947419535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
