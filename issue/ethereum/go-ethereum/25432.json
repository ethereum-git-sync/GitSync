{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25432",
  "id": 1321379807,
  "node_id": "I_kwDOAOvK985Owqff",
  "number": 25432,
  "title": "Performance Regression in Geth v1.10.21",
  "user": {
    "login": "gabronick",
    "id": 54854657,
    "node_id": "MDQ6VXNlcjU0ODU0NjU3",
    "avatar_url": "https://avatars.githubusercontent.com/u/54854657?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gabronick",
    "html_url": "https://github.com/gabronick",
    "followers_url": "https://api.github.com/users/gabronick/followers",
    "following_url": "https://api.github.com/users/gabronick/following{/other_user}",
    "gists_url": "https://api.github.com/users/gabronick/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gabronick/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gabronick/subscriptions",
    "organizations_url": "https://api.github.com/users/gabronick/orgs",
    "repos_url": "https://api.github.com/users/gabronick/repos",
    "events_url": "https://api.github.com/users/gabronick/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gabronick/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-07-28T19:24:18Z",
  "updated_at": "2022-08-07T16:21:18Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: Geth v1.10.21\r\nOS & Version: Linux Amazon EC2 5.10.130-118.517.amzn2.aarch64\r\n\r\n#### Expected behaviour\r\n\r\nblocks are processed very fast, several blocks usually take a few seconds, the server runs on NVME\r\n\r\nexample:\r\n\r\n Imported new chain segment               blocks=76  txs=12404 mgas=1108.491 elapsed=8.108s mgasps=136.710 number=15,197,808 hash=aab71b..b5f1e8 age=5d11h4m  dirty=123.00MiB\r\n\r\n\r\n#### Actual behaviour\r\n\r\nImported new chain segment               blocks=5   txs=1250  mgas=115.102  elapsed=59.160s   mgasps=1.946   number=15,232,749 hash=3fd81a..e5dd9d age=16m36s    dirty=5.14GiB\r\n\r\nthe blocks start to process so slowly that the node lags, the only way is to restart the node\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nlet the node run for a while,\r\n\r\nUPDATE:\r\n\r\nafter going back to version .20 the stability has improved, we have never seen this behavior before and the workload is constant",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1204940842",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25432#issuecomment-1204940842",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432",
    "id": 1204940842,
    "node_id": "IC_kwDOAOvK985H0fAq",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-04T08:33:53Z",
    "updated_at": "2022-08-04T08:33:53Z",
    "author_association": "MEMBER",
    "body": "Thanks for the report!\r\n\r\nCan you let us now the command line parameters that you start geth with?\r\n\r\nIt *may* be related to this change:\r\n> We have reverted to an older version of goleveldb because recent versions have buggy compaction and manifest handling. (https://github.com/ethereum/go-ethereum/pull/25413)\r\n\r\nbut needs more investigation.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1204940842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1204940929",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25432#issuecomment-1204940929",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25432",
    "id": 1204940929,
    "node_id": "IC_kwDOAOvK985H0fCB",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-04T08:33:58Z",
    "updated_at": "2022-08-04T08:33:58Z",
    "author_association": "MEMBER",
    "body": "A theory why it *could be* slow:\r\n\r\nIn geth v1.10.20, we upgraded to a broken version of leveldb which may skip database compaction in some cases. When you upgrade to .21, it could be that leveldb needs to perform significant compaction work, which would reduce performance until that's done.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1204940929/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
