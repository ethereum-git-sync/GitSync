{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25596",
  "id": 1350153391,
  "node_id": "I_kwDOAOvK985QebSv",
  "number": 25596,
  "title": "1.10.23 fresh mainnet sync stalled",
  "user": {
    "login": "yorickdowne",
    "id": 71337066,
    "node_id": "MDQ6VXNlcjcxMzM3MDY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yorickdowne",
    "html_url": "https://github.com/yorickdowne",
    "followers_url": "https://api.github.com/users/yorickdowne/followers",
    "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
    "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
    "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
    "repos_url": "https://api.github.com/users/yorickdowne/repos",
    "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-08-25T00:18:58Z",
  "updated_at": "2022-08-26T16:12:32Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.10.23`\r\nOS & Version: Linux\r\n\r\n#### What\r\n\r\nFresh sync on empty DB of Ethereum mainnet. Eventually stalls for about 3 hours, last log messages:\r\n\r\n```\r\nexecution_1         | INFO [08-24|20:09:46.928] Imported new block receipts              count=442  elapsed=504.841ms   number=15,089,993 hash=741f72..f4ade1 age=1mo2w5d    size=68.28MiB\r\nexecution_1         | INFO [08-24|20:09:46.929] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=2665h49m35.199s\r\nexecution_1         | INFO [08-24|20:12:59.927] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=2711h43m55.893s\r\nexecution_1         | WARN [08-24|20:13:14.441] Snapshot extension registration failed   peer=327cb76d err=\"peer connected on snap without compatible eth support\"\r\nexecution_1         | INFO [08-24|20:13:26.758] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=2718h7m47.399s\r\nexecution_1         | WARN [08-24|20:13:31.298] Snapshot extension registration failed   peer=6de3885d err=\"peer connected on snap without compatible eth support\"\r\nexecution_1         | INFO [08-24|20:13:45.646] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=2722h37m9.802s\r\nexecution_1         | WARN [08-24|20:13:46.280] Dropping unsynced node during sync       id=e9de0878ad2242f7 conn=inbound addr=47.95.116.123:52658             type=Geth/v1.10.23-stable...\r\nexecution_1         | WARN [08-24|20:13:48.597] Snapshot extension registration failed   peer=decab1a9 err=\"peer connected on snap without compatible eth support\"\r\nexecution_1         | INFO [08-24|20:14:01.764] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=2726h28m22.624s\r\nexecution_1         | INFO [08-24|21:02:48.376] Writing clean trie cache to disk         path=/var/lib/goethereum/geth/triecache      threads=1\r\nexecution_1         | INFO [08-24|21:02:48.376] Regenerated local transaction journal    transactions=0 accounts=0\r\nexecution_1         | INFO [08-24|21:02:48.392] Persisted the clean trie cache           path=/var/lib/goethereum/geth/triecache      elapsed=16.049ms\r\nexecution_1         | INFO [08-24|21:15:55.166] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=3609h56m37.427s\r\nexecution_1         | INFO [08-24|21:16:39.690] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=3620h31m53.779s\r\nexecution_1         | INFO [08-24|22:02:48.375] Writing clean trie cache to disk         path=/var/lib/goethereum/geth/triecache      threads=1\r\nexecution_1         | INFO [08-24|22:02:48.375] Regenerated local transaction journal    transactions=0 accounts=0\r\nexecution_1         | INFO [08-24|22:02:48.388] Persisted the clean trie cache           path=/var/lib/goethereum/geth/triecache      elapsed=12.659ms\r\nexecution_1         | INFO [08-24|23:02:48.376] Regenerated local transaction journal    transactions=0 accounts=0\r\nexecution_1         | INFO [08-24|23:02:48.376] Writing clean trie cache to disk         path=/var/lib/goethereum/geth/triecache      threads=1\r\nexecution_1         | INFO [08-24|23:02:48.391] Persisted the clean trie cache           path=/var/lib/goethereum/geth/triecache      elapsed=15.105ms\r\nexecution_1         | INFO [08-24|23:03:33.232] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=5146h23m1.367s\r\nexecution_1         | INFO [08-24|23:03:48.212] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=5149h56m16.576s\r\nexecution_1         | WARN [08-24|23:03:56.567] Dropping unsynced node during sync       id=87d9aace46398de2 conn=inbound addr=3.66.140.34:44640               type=\r\nexecution_1         | INFO [08-24|23:04:12.949] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=5155h50m57.204s\r\nexecution_1         | WARN [08-24|23:04:13.026] Dropping unsynced node during sync       id=24877dcb4101f157 conn=inbound addr=47.149.49.97:58824              type=besu/v22.7.1/linux-x...\r\nexecution_1         | INFO [08-24|23:04:23.220] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=5158h16m51.799s\r\nexecution_1         | WARN [08-24|23:04:35.321] Dropping unsynced node during sync       id=4d4380f0c12abda7 conn=inbound addr=18.142.232.3:53926              type=\r\nexecution_1         | WARN [08-24|23:04:50.023] Snapshot extension registration failed   peer=2df6ffae err=\"peer connected on snap without compatible eth support\"\r\nexecution_1         | INFO [08-24|23:04:58.225] State sync in progress                   synced=0.12% state=149.97MiB accounts=385,037@49.68MiB slots=454,877@91.66MiB codes=3544@8.63MiB eta=5166h35m12.180s\r\n\r\nexecution_1         | INFO [08-25|00:02:48.375] Writing clean trie cache to disk         path=/var/lib/goethereum/geth/triecache      threads=1\r\nexecution_1         | INFO [08-25|00:02:48.375] Regenerated local transaction journal    transactions=0 accounts=0\r\nexecution_1         | INFO [08-25|00:02:48.389] Persisted the clean trie cache           path=/var/lib/goethereum/geth/triecache      elapsed=13.788ms\r\n```\r\n\r\nRestarting Geth had it grabbing receipts and headers again. After restart state sync progresses, which it didn't during the first run, and ETA is sane, around 3.5 hours for state sync. Sync did complete after this restart.\r\n\r\nThis is connected to a fully synced CL via Engine API, not that that should matter pre-merge.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1226700385",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25596#issuecomment-1226700385",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596",
    "id": 1226700385,
    "node_id": "IC_kwDOAOvK985JHfZh",
    "user": {
      "login": "garyng2000",
      "id": 241666,
      "node_id": "MDQ6VXNlcjI0MTY2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/241666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyng2000",
      "html_url": "https://github.com/garyng2000",
      "followers_url": "https://api.github.com/users/garyng2000/followers",
      "following_url": "https://api.github.com/users/garyng2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyng2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyng2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyng2000/subscriptions",
      "organizations_url": "https://api.github.com/users/garyng2000/orgs",
      "repos_url": "https://api.github.com/users/garyng2000/repos",
      "events_url": "https://api.github.com/users/garyng2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyng2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T02:34:16Z",
    "updated_at": "2022-08-25T02:34:16Z",
    "author_association": "NONE",
    "body": "I am seeing similar stall too(after removedb but ancient data kept). the state sync stalked at 79% and the import header also stalled for about 30 minutes and lagged by a hundred or so blocks and counting. thinking if I should restart to see if it can continue but at the same time it seems to be doing db compaction as that message still periodically showing",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1226700385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1228671217",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25596#issuecomment-1228671217",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596",
    "id": 1228671217,
    "node_id": "IC_kwDOAOvK985JPAjx",
    "user": {
      "login": "ryanschneider",
      "id": 53520,
      "node_id": "MDQ6VXNlcjUzNTIw",
      "avatar_url": "https://avatars.githubusercontent.com/u/53520?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanschneider",
      "html_url": "https://github.com/ryanschneider",
      "followers_url": "https://api.github.com/users/ryanschneider/followers",
      "following_url": "https://api.github.com/users/ryanschneider/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanschneider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanschneider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanschneider/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanschneider/orgs",
      "repos_url": "https://api.github.com/users/ryanschneider/repos",
      "events_url": "https://api.github.com/users/ryanschneider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanschneider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-26T16:00:45Z",
    "updated_at": "2022-08-26T16:00:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "In the past these stalls have often been caused by leveldb compaction, but there used to be a log at IIRC warning level when that happened.  Maybe .23 has a regression where the compaction warning isn't being output?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1228671217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1228681235",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25596#issuecomment-1228681235",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25596",
    "id": 1228681235,
    "node_id": "IC_kwDOAOvK985JPDAT",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-26T16:11:06Z",
    "updated_at": "2022-08-26T16:12:32Z",
    "author_association": "NONE",
    "body": "3 hours though? This is a baremetal machine with a \"data center\" NVMe. When it compacts DB that typically takes around 3 minutes, not 3 hours.\r\n\r\nWhat's odd is that state sync wasn't progressing through the sync, until restart. That, I also have never seen before. It doesn't just stay at 0.12% for hours on end.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1228681235/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
