{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2691",
  "id": 160039242,
  "node_id": "MDU6SXNzdWUxNjAwMzkyNDI=",
  "number": 2691,
  "title": "Geth keystore hardening",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 248602208,
      "node_id": "MDU6TGFiZWwyNDg2MDIyMDg=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:crypto",
      "name": "area:crypto",
      "color": "bfd4f2",
      "default": false,
      "description": null
    },
    {
      "id": 856638432,
      "node_id": "MDU6TGFiZWw4NTY2Mzg0MzI=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:inactive",
      "name": "status:inactive",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2016-06-13T20:37:17Z",
  "updated_at": "2018-04-16T15:37:37Z",
  "closed_at": "2018-04-16T15:37:37Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "I experimented a bit with placing a file in the keystore:\n\n```\n    [~/.ethereum/keystore]\n    #ls\n    foobar\n    UTC--2015-07-08T22:07:57.622568876Z--b9e4043f94887eb59e988bc6b9b64f8bb0ded601\n    UTC--2015-08-12T19-41-43.847550229Z--6a06499ceee3ea86f394568874b5bdf6e9e26074\n    [~/.ethereum/keystore]\n```\n\nA very simple file:\n\n```\n    #cat foobar\n    {\"address\":\"00001337133713371337133713371337deadbeef\"}\n```\n\nIt shows up\n\n```\n    > personal.listAccounts\n    [\"0xb9e4043f94887eb59e988bc6b9b64f8bb0ded601\",\n\"0x6a06499ceee3ea86f394568874b5bdf6e9e26074\",\n\"0x00001337133713371337133713371337deadbeef\"]\n```\n\nWe can make the '1337' accounts become 'default' (index 0), by simply\nensuring that the filename is _before_ the others in the dir-listing. The\nnormal keyfiles starts with \"UTC--\", so if we for example call it \"Q\":\n\n```\n    [~/.ethereum/keystore]\n    #cat Q\n    {\"address\":\"00001337133713371337133713371337deadbeef\"}\n```\n\n we get this:\n\n```\n    > personal.listAccounts\n    [\"0x00001337133713371337133713371337deadbeef\",\n\"0xb9e4043f94887eb59e988bc6b9b64f8bb0ded601\",\n\"0x6a06499ceee3ea86f394568874b5bdf6e9e26074\"]\n```\n\nThis is not a 0-day, but could potentially be used in a situation where\nan attacker does not have full RCE (remote command execution) or ability\nto read files, but _has_ ability to write files to the system. With a\nbit of luck, the user will at some point deposit some ether to his\ndefault account ... which is not his account at all.\n\nThese kinds of bugs can be quite nasty, which by themselves are very\nobscure and limited, but combined with another limited bug (e.g in mist,\nhttp-rpc or OS) it can have severe consequences in some cases.\n\nI don't know really how this would be mitigated, short of unlocking the\nprivate key for each account and checking the public address (which is a\nbad solution). One mitigation could be to use randomized keystore, so\nthe keystore folder is named \".ethereum/keystore-`randomjunk`\". That\nwould mean that the attacker needs to either be able to create a\ndirectory OR list directories to find the right one.\n\nPS. I originally reported this via the bug bounty, but was asked to make a GH issue instead. \n",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/237158107",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2691#issuecomment-237158107",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691",
    "id": 237158107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzE1ODEwNw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-03T06:57:29Z",
    "updated_at": "2016-08-03T07:05:02Z",
    "author_association": "MEMBER",
    "body": "I just tested Mist, which shows my 9-million-ether account (the poloniex cold wallet, which I do not own :) ) as the main one, with options to easily deposit ether in there. Someone could easily fall for this.\n\n![image](https://cloud.githubusercontent.com/assets/142290/17356531/4a84d4ae-5958-11e6-95f8-0811cf720438.png)\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/237158107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/370440941",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2691#issuecomment-370440941",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2691",
    "id": 370440941,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDQ0MDk0MQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-03-05T14:44:30Z",
    "updated_at": "2018-03-05T14:44:30Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/370440941/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
