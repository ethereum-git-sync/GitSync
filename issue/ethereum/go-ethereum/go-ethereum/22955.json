{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22955",
  "id": 903746336,
  "node_id": "MDU6SXNzdWU5MDM3NDYzMzY=",
  "number": 22955,
  "title": "Impossible reorg error",
  "user": {
    "login": "easeev",
    "id": 14873170,
    "node_id": "MDQ6VXNlcjE0ODczMTcw",
    "avatar_url": "https://avatars.githubusercontent.com/u/14873170?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/easeev",
    "html_url": "https://github.com/easeev",
    "followers_url": "https://api.github.com/users/easeev/followers",
    "following_url": "https://api.github.com/users/easeev/following{/other_user}",
    "gists_url": "https://api.github.com/users/easeev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/easeev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/easeev/subscriptions",
    "organizations_url": "https://api.github.com/users/easeev/orgs",
    "repos_url": "https://api.github.com/users/easeev/repos",
    "events_url": "https://api.github.com/users/easeev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/easeev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-05-27T13:24:23Z",
  "updated_at": "2021-12-26T05:28:50Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16\r\n\r\n#### Problem description\r\n\r\n```\r\nINFO [05-27|13:12:32.956] Initialising Ethereum protocol           network=1 dbversion=8\r\nINFO [05-27|13:12:34.670] Loaded most recent local header          number=12509751 hash=\"3d39e9…3f7aeb\" td=25288703045413463639157 age=1d1h31m\r\nINFO [05-27|13:12:34.670] Loaded most recent local full block      number=12472778 hash=\"b15483…c12d5b\" td=24997582361841290640474 age=6d19h5m\r\nINFO [05-27|13:12:34.670] Loaded most recent local fast block      number=12472749 hash=\"74b829…4bb9c2\" td=24997344858324798202547 age=6d19h12m\r\nINFO [05-27|13:12:34.672] Loaded last fast-sync pivot marker       number=11618208\r\nWARN [05-27|13:12:34.678] Head state missing, repairing            number=12472778 hash=\"b15483…c12d5b\" snaproot=\"afea8f…88a3b2\"\r\nINFO [05-27|13:12:41.113] Loaded most recent local header          number=12509751 hash=\"3d39e9…3f7aeb\" td=25288703045413463639157 age=1d1h31m\r\nINFO [05-27|13:12:41.113] Loaded most recent local full block      number=12470233 hash=\"c93484…b5a0c3\" td=24976529094439547081413 age=1w4h36m\r\nINFO [05-27|13:12:41.113] Loaded most recent local fast block      number=12472749 hash=\"74b829…4bb9c2\" td=24997344858324798202547 age=6d19h12m\r\nINFO [05-27|13:12:41.113] Loaded last fast-sync pivot marker       number=11618208\r\nWARN [05-27|13:12:41.115] Enabling snapshot recovery               chainhead=12470233 diskbase=12471603\r\nWARN [05-27|13:12:41.128] Loaded snapshot journal                  diskroot=\"afea8f…88a3b2\" diffs=unmatched\r\nWARN [05-27|13:12:41.128] Snapshot is not continuous with chain    snaproot=\"afea8f…88a3b2\" chainroot=\"fa241a…9dcae3\"\r\nINFO [05-27|13:12:41.129] Loaded local transaction journal         transactions=0 dropped=0\r\nINFO [05-27|13:12:41.129] Regenerated local transaction journal    transactions=0 accounts=0\r\nWARN [05-27|13:12:41.131] Old unclean shutdowns found              count=256\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T11:55:37+0000 age=1h17m4s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:02:10+0000 age=1h10m31s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:09:01+0000 age=1h3m40s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:15:59+0000 age=56m42s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:22:41+0000 age=50m\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:29:40+0000 age=43m1s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:36:15+0000 age=36m26s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:43:10+0000 age=29m31s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:50:02+0000 age=22m39s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T12:56:53+0000 age=15m48s\r\nWARN [05-27|13:12:41.131] Unclean shutdown detected                booted=2021-05-27T13:05:48+0000 age=6m53s\r\nINFO [05-27|13:12:41.131] Starting peer-to-peer node               instance=Geth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16\r\nINFO [05-27|13:12:41.360] New local node record                    seq=20147 id=84100dcc38e8a1c4 ip=127.0.0.1 udp=30303 tcp=30303\r\nINFO [05-27|13:12:41.361] Started P2P networking                   self=enode://72072da1d382cf58a6698ddc6b51e291cba59439f80b3a37af04df56aefb8fc7d5cfd08b0395dca3f163cbeb92b089688bee922c2ce7d8d5f9d476973e3d5473@127.0.0.1:30303\r\nINFO [05-27|13:12:51.391] New local node record                    seq=20148 id=84100dcc38e8a1c4 ip=51.11.172.167 udp=11264 tcp=30303\r\nINFO [05-27|13:12:51.493] Looking for peers                        peercount=2 tried=22 static=1\r\nINFO [05-27|13:13:01.533] Looking for peers                        peercount=2 tried=36 static=1\r\nINFO [05-27|13:13:01.816] Block synchronisation started\r\nINFO [05-27|13:13:02.172] Downloader queue stats                   receiptTasks=0 blockTasks=54 itemSize=10.70KiB throttle=6126\r\nINFO [05-27|13:13:11.539] Looking for peers                        peercount=1 tried=43 static=1\r\nINFO [05-27|13:13:11.546] Importing heavy sidechain segment        blocks=1276 start=12508901 end=12510176\r\nERROR[05-27|13:13:32.592] Snapshot extension registration failed   peer=5e8011ec err=\"peer connected on snap without compatible eth support\"\r\nERROR[05-27|13:13:45.329] Snapshot extension registration failed   peer=3af25a30 err=\"peer connected on snap without compatible eth support\"\r\nERROR[05-27|13:13:57.682] Impossible reorg, please file an issue   oldnum=12470233 oldhash=\"c93484…b5a0c3\" newnum=12470233 newhash=\"c93484…b5a0c3\"\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853693358",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22955#issuecomment-853693358",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955",
    "id": 853693358,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzY5MzM1OA==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-03T08:36:33Z",
    "updated_at": "2021-06-03T08:36:33Z",
    "author_association": "MEMBER",
    "body": "Thanks for reporting the problem! We are looking into it - unfortunately this one is hard to tackle - but should also not interrupt your service.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853693358/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1001101560",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22955#issuecomment-1001101560",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22955",
    "id": 1001101560,
    "node_id": "IC_kwDOAOvK9847q5j4",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-26T03:27:17Z",
    "updated_at": "2021-12-26T05:28:50Z",
    "author_association": "NONE",
    "body": "I caught this error after having to panic close geth when it wouldn't shutdown cleanly.  As suggested, it eventually caught up to the head of the chain and resumed with no issues.\r\n\r\n*edit*  Actually, it seems to repeatedly fall out of sync and generate other errors.  Ultimately, I wiped the db and started fresh.\r\n\r\n```\r\nERROR[12-26|00:15:54.494] Impossible reorg, please file an issue   oldnum=23245 oldhash=6eaf63..6366ec oldblocks=43999 newnum=23245 newhash=6eaf63..6366ec newblocks=0\r\nINFO [12-26|00:15:54.642] Ignoring already processed block         number=23270 hash=89cab5..fa3ea3\r\nINFO [12-26|00:15:54.685] Setting head                             head=89cab5..fa3ea3\r\nINFO [12-26|00:15:55.336] Ignoring already processed block         number=23271 hash=d503ac..50b5d5\r\nINFO [12-26|00:15:55.379] Setting head                             head=d503ac..50b5d5\r\nINFO [12-26|00:15:55.760] Set the chain head                       number=23245 hash=6eaf63..6366ec\r\nERROR[12-26|00:15:55.760] Failed to reset txpool state             err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nERROR[12-26|00:15:55.760] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.760] Set the chain head                       number=23246 hash=c43648..246b17\r\nERROR[12-26|00:15:55.760] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.760] Set the chain head                       number=23247 hash=ad9752..64eadf\r\nERROR[12-26|00:15:55.760] Failed to reset txpool state             err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.760] Set the chain head                       number=23248 hash=41c9c4..0622d8\r\nERROR[12-26|00:15:55.760] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23249 hash=007781..dfcd3d\r\nERROR[12-26|00:15:55.761] Failed to reset txpool state             err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23250 hash=cd4adc..739092\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nERROR[12-26|00:15:55.761] Failed to reset txpool state             err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23251 hash=a49949..286314\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23252 hash=6e85a6..080686\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23253 hash=b71423..984858\r\nERROR[12-26|00:15:55.761] Failed to reset txpool state             err=\"missing trie node e526d83fec9fbfc3c112c1b77d8974e36511099ea1b1a6bf3cb4029196184863 (path )\"\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node 1acee624b4867b1b55cd9e86b798836d2bcc50c1b1c3faf4790355bfb4af7cc7 (path )\"\r\nINFO [12-26|00:15:55.761] Set the chain head                       number=23254 hash=83c427..2501fd\r\nERROR[12-26|00:15:55.761] Failed to create mining context          err=\"missing trie node 1acee624b4867b1b55cd9e86b798836d2bcc50c1b1c3faf4790355bfb4af7cc7 (path )\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1001101560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
