{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/10715",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/10715/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/10715/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/10715/events",
  "html_url": "https://github.com/ethereum/solidity/issues/10715",
  "id": 778811926,
  "node_id": "MDU6SXNzdWU3Nzg4MTE5MjY=",
  "number": 10715,
  "title": "Investigate source mappings for reverts after optimization. Resp. how to deal with the optimizer collapsing source locations.",
  "user": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1017612679,
      "node_id": "MDU6TGFiZWwxMDE3NjEyNjc5",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/protocol%20design%20:crystal_ball:",
      "name": "protocol design :crystal_ball:",
      "color": "8af77e",
      "default": false,
      "description": "Potential changes to ABI, meta data, standard JSON"
    },
    {
      "id": 1282209978,
      "node_id": "MDU6TGFiZWwxMjgyMjA5OTc4",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/optimizer",
      "name": "optimizer",
      "color": "d4c5f9",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-01-05T09:38:03Z",
  "updated_at": "2021-01-07T03:01:47Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Reported by @haltman-at on gitter:\r\n\r\n>   hey, according to the Brownie people there's an issue in Solidity 0.8.0 where it will generate incorrect source mappings for reverts: eth-brownie/brownie#907 (they don't seem to have filed a Solidity issue for it) However I can't seem to reproduce this issue myself. Does anyone know if this is real?\r\n  if it is, I want to suggest that the relevant overlapping code should either lie in a generated source, or else simply be unmapped, so that this problem doesn't happen. but, I can't reproduce it, so I don't even know if it's real\r\n\r\nIIUC the issue is that the optimizer collapses source locations - not sure if we can do much about this, unless we allow a piece of bytecode to point to multiple source locations in the source mappings.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/10715/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/10715/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/755075240",
    "html_url": "https://github.com/ethereum/solidity/issues/10715#issuecomment-755075240",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10715",
    "id": 755075240,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTA3NTI0MA==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T04:46:53Z",
    "updated_at": "2021-01-06T04:46:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, so, to be clear, the problem only happens with the optimizer turned on (I didn't understand this at first which was why I wasn't sure it was real), which makes it arguably not a bug, but it is annoying.\r\n\r\nFor obvious reasons, I don't think making one piece of bytecode point to two source locations makes any sense.  However -- to repeat what I said on Gitter -- if it would be possible to instead just mark that code as unmapped, or for it to live in a generated source, then it seems to me that would also get rid of the problem of misleading stacktraces?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/755075240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/755206183",
    "html_url": "https://github.com/ethereum/solidity/issues/10715#issuecomment-755206183",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10715",
    "id": 755206183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTIwNjE4Mw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T10:03:38Z",
    "updated_at": "2021-01-06T10:03:38Z",
    "author_association": "MEMBER",
    "body": "Well, pointing to several source locations would be the most accurate, especially since this may happen a lot more often and for any kind of user-code as well once we switch to Sol->Yul codegen... but it may of course not be very practical... and also probably not very useful unless a jump would also mark into which set of those multiple source locations it would jump (if that is even always possible)...\r\nFor now it should probably just be marked as generated source, but this will haunt us back in the future with Yul-IR-codegen in general, so maybe worth thinking about how we want to deal with this in general in the future...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/755206183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
