{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11078",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11078/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11078/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11078/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11078",
  "id": 826719606,
  "node_id": "MDU6SXNzdWU4MjY3MTk2MDY=",
  "number": 11078,
  "title": "Static calls to known (or known-pure) precompiles should be considered pure rather than just view",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 785717317,
      "node_id": "MDU6TGFiZWw3ODU3MTczMTc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/language%20design%20:rage4:",
      "name": "language design :rage4:",
      "color": "9d76d3",
      "default": false,
      "description": "Any changes to the language, e.g. new features"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-03-09T22:20:07Z",
  "updated_at": "2022-08-17T13:49:44Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Abstract\r\n\r\nSo, since Solidity isn't adding any new precompiles (see #3165), I tried actually implementing a precompiles library as described in that issue.  But I encountered the problem that, unless I was going to use assembly, all the functions had to be marked `view` rather than `pure`, because Solidity currently has no way of knowing that `x.staticcall(...)` won't alter the state when `x` is the address of a precompile.  Doing calls in assembly is a pain (or at least is for my purposes), so it would be nice if this could be done without resorting to assembly.  So, ideally, Solidity would consider static calls to known precompiles as pure.  (This is related to #6558, except I'm asking about the Solidity rather than assembly equivalent, because I'm trying to avoid using assembly.)\r\n\r\n(Note that #6558 says \"known-pure\" precompiles; I've abbreviated that to \"known precompiles\", as all known precompiles, at least currently, are known-pure.  However the distinction can of course be kept in mind if for some reason that ever changes.)\r\n\r\n(Possibly this could be expanded to cover all zero-value calls, rather than just static calls, but that seems more complicated.)\r\n\r\n## Specification\r\n\r\nAs mentioned, static calls to known-pure precompiles should be considered pure.  Obviously, this feature would have to be restricted to calls whose address can be known at compile-time; so `address(5).staticcall(...)` should work, but a more general `x.staticcall(...)` would never be considered `pure` no matter the value of `x`.  (I mean, obviously, as `pure` is a compile-time notion, but just to be clear.)\r\n\r\nSimilarly, if this were to be expanded to all zero-value calls, it would have to only be calls which could be known to be zero-value at compile time.\r\n\r\nThe question then is, what's a known precompile?  I think there are two possible approaches here:\r\n1. The list of known precompiles depends on the hardfork; 1-4 as of Frontier, 1-8 as of Byzantium, 1-9 as of Istanbul.\r\n2. Just assume [EIP-1352](https://eips.ethereum.org/EIPS/eip-1352), or something similar, even though it's still a draft.  (If a particular precompile, such as 0, doesn't currently exist... well, then it's the \"always returns empty\" precompile. :P )\r\n\r\nObviously, (2) is quite a bit simpler here.\r\n\r\n## Backwards Compatibility\r\n\r\nThere should be no backwards compatibility issues.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11078/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11078/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/800181953",
    "html_url": "https://github.com/ethereum/solidity/issues/11078#issuecomment-800181953",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11078",
    "id": 800181953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMDE4MTk1Mw==",
    "user": {
      "login": "hrkrshnn",
      "id": 13174375,
      "node_id": "MDQ6VXNlcjEzMTc0Mzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13174375?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hrkrshnn",
      "html_url": "https://github.com/hrkrshnn",
      "followers_url": "https://api.github.com/users/hrkrshnn/followers",
      "following_url": "https://api.github.com/users/hrkrshnn/following{/other_user}",
      "gists_url": "https://api.github.com/users/hrkrshnn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hrkrshnn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hrkrshnn/subscriptions",
      "organizations_url": "https://api.github.com/users/hrkrshnn/orgs",
      "repos_url": "https://api.github.com/users/hrkrshnn/repos",
      "events_url": "https://api.github.com/users/hrkrshnn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hrkrshnn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-16T11:32:30Z",
    "updated_at": "2021-03-16T11:32:30Z",
    "author_association": "MEMBER",
    "body": "Can you share how you do it in inline assembly? I think `staticcall` in inline assembly should be reported as `view`, rather than `pure`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/800181953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
