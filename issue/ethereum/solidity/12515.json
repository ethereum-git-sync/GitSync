{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12515/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12515/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12515/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12515",
  "id": 1099312528,
  "node_id": "I_kwDOAm_5kc5Bhi2Q",
  "number": 12515,
  "title": "Overhaul and modernize CMake setup.",
  "user": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 437863668,
      "node_id": "MDU6TGFiZWw0Mzc4NjM2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/build%20system%20:building_construction:",
      "name": "build system :building_construction:",
      "color": "1d76db",
      "default": false,
      "description": ""
    },
    {
      "id": 4438003076,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaNhA",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/medium%20effort",
      "name": "medium effort",
      "color": "ff7df7",
      "default": false,
      "description": "Default level of effort"
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "5d71ff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    },
    {
      "id": 4438490842,
      "node_id": "LA_kwDOAm_5kc8AAAABCI3-2g",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/should%20have",
      "name": "should have",
      "color": "ffbe6c",
      "default": false,
      "description": "We like the idea but itâ€™s not important enough to be a part of the roadmap."
    },
    {
      "id": 4525128519,
      "node_id": "LA_kwDOAm_5kc8AAAABDbf7Rw",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/needs%20design",
      "name": "needs design",
      "color": "18F737",
      "default": false,
      "description": "The proposal is too vague to be implemented right away"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2022-01-11T15:40:14Z",
  "updated_at": "2022-09-14T14:43:41Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Our cmake setup is an organically grown mess that today violates pretty much every best practice for writing clean modern cmake code.\r\n\r\nOne example is the entire mess around ``EthCompilerSettings``. What we should really do is to define an ``INTERFACE`` library to collect flags and pass them to the appropriate targets. Stuff like ``fdiagnostics-color`` has no business being defined there at all, that belongs in the user's configuration. Things like ``CMAKE_CXX_FLAGS_DEBUG`` should remain untouched. Etc. pp...\r\n\r\nFrom all the issues and questionable things I see in this file alone, I'd actually tend to say we should just rewrite the cmake logic entirely - that can be done quickly and cleanly.\r\n\r\nFor the record: this was triggered by ``$<$<COMPILE_LANGUAGE:CXX>:-Wextra-semi>`` in ``EthCompilerSettings`` breaking for @christianparpart, after which we realized that our cmake setup is broken for ninja builds entirely right now. But the entire mechanism there is one single hack that should be replaced :-). \r\nhttps://github.com/ethereum/solidity/pull/11422 tried to work on this part once, but to be honest the result was not much better than what we have and also contrary to my understanding of modern cmake best practices.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12515/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12515/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010089613",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1010089613",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1010089613,
    "node_id": "IC_kwDOAm_5kc48NL6N",
    "user": {
      "login": "christianparpart",
      "id": 56763,
      "node_id": "MDQ6VXNlcjU2NzYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/56763?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/christianparpart",
      "html_url": "https://github.com/christianparpart",
      "followers_url": "https://api.github.com/users/christianparpart/followers",
      "following_url": "https://api.github.com/users/christianparpart/following{/other_user}",
      "gists_url": "https://api.github.com/users/christianparpart/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/christianparpart/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/christianparpart/subscriptions",
      "organizations_url": "https://api.github.com/users/christianparpart/orgs",
      "repos_url": "https://api.github.com/users/christianparpart/repos",
      "events_url": "https://api.github.com/users/christianparpart/events{/privacy}",
      "received_events_url": "https://api.github.com/users/christianparpart/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-11T15:43:19Z",
    "updated_at": "2022-01-11T15:43:19Z",
    "author_association": "MEMBER",
    "body": "Thanks @ekpyron for filing this ticket! We could gather the requirements of what we expect and then see how we can best achieve that. (I'm not saying we should move away from CMake btw - whatever fits best) :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010089613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010090875",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1010090875",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1010090875,
    "node_id": "IC_kwDOAm_5kc48NMN7",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-11T15:44:38Z",
    "updated_at": "2022-01-11T15:44:38Z",
    "author_association": "MEMBER",
    "body": "We should most definitely stay with cmake - it's the only sane choice. But we should use it properly.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010090875/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010999839",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1010999839",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1010999839,
    "node_id": "IC_kwDOAm_5kc48QqIf",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T12:33:06Z",
    "updated_at": "2022-01-12T12:33:06Z",
    "author_association": "MEMBER",
    "body": "> Stuff like `fdiagnostics-color` has no business being defined there at all, that belongs in the user's configuration.\r\n\r\nWhat do you mean by user configuration? Flags passed to CMake? If so then I think we should keep that one. The thing is that by default output is not colored and hard to read. I think it should be enabled by default and that's AFAIK the way to do it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1010999839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011014572",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1011014572",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1011014572,
    "node_id": "IC_kwDOAm_5kc48Qtus",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T12:52:46Z",
    "updated_at": "2022-01-12T12:52:46Z",
    "author_association": "MEMBER",
    "body": "The flag is a question of taste and depends on your situation. You may run stuff in an environment, in which colored output is harmful. If you think colored output is more readable in general, then the flag should be in your ``C(XX)FLAGS`` at all times and cmake will automatically pick it up. Stuff like this has nothing to do with the actual build process, so we shouldn't mess with it.\r\n\r\nBut it's only one of a whole bunch of issues and I don't really mind in this particular case, just saying from my perspective this is also definitely bad style.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011014572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011016256",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1011016256",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1011016256,
    "node_id": "IC_kwDOAm_5kc48QuJA",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T12:55:08Z",
    "updated_at": "2022-01-12T12:55:08Z",
    "author_association": "MEMBER",
    "body": "Or tell gcc to make it the default on a terminal that supports colors. Which as a matter of fact is what gcc does anyways, so the flag is redundant in all cases in which it's reasonable anyways.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011016256/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011147011",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1011147011",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1011147011,
    "node_id": "IC_kwDOAm_5kc48ROED",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T15:14:01Z",
    "updated_at": "2022-01-12T15:14:01Z",
    "author_association": "MEMBER",
    "body": "Maybe. I'm looking at it from a practical standpoint - when I joined the project it wasn't obvious at all why it's not enabled by default and how to enable it. Turned out that we had that flag but only for one of the compilers. I think new contributors should not have to go through that. If there's a better way to achieve that then fine but so far I think that having it in the build config solved the issue nicely. I'm not seeing ANSI escapes in logs people post or in CI so it seems to work fine as is.\r\n\r\nAnyway, I completely agree with the need to clean up the CMake config but I'm not sure if a rewrite from scratch is the best way to go about it. In my experience smaller, iterative improvements are easier to pull off (there's never time for a big rewrite :)). And with a rewrite it always turns out that half of these warts actually had a good reason to be there and must be painfully restored through bug reports :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011147011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011241972",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1011241972",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1011241972,
    "node_id": "IC_kwDOAm_5kc48RlP0",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T16:42:48Z",
    "updated_at": "2022-01-12T16:42:48Z",
    "author_association": "MEMBER",
    "body": "Usually you may be right, but in this case, I'm pretty sure that a rewrite is significantly easier than trying to fix this :-). But doesn't matter that much to me how to do it, but yeah, it does need cleanup :-).\r\n\r\n[Not that we need to argue through it further - but it's rather curious that the color stuff wouldn't have worked by default - for me even pure plain ``gcc`` emits colors without any flag unless explicitly disabled, if it runs in a terminal that claims to support colors... might be that that's newer gcc behaviour, though]",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011241972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011255645",
    "html_url": "https://github.com/ethereum/solidity/issues/12515#issuecomment-1011255645",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12515",
    "id": 1011255645,
    "node_id": "IC_kwDOAm_5kc48Rold",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T16:56:58Z",
    "updated_at": "2022-01-12T16:57:21Z",
    "author_association": "MEMBER",
    "body": "Right. Maybe it has changed in the newer compilers. Anyway, you're right, no point in getting deeper into it here, we can argue it in the PR when we actually have one :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1011255645/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
