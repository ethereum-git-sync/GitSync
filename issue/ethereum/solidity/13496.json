{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13496",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13496/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13496/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13496/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13496",
  "id": 1365048074,
  "node_id": "I_kwDOAm_5kc5RXPsK",
  "number": 13496,
  "title": "Segmentation fault compiling a contract with huge data and via-IR enabled",
  "user": {
    "login": "r0qs",
    "id": 457348,
    "node_id": "MDQ6VXNlcjQ1NzM0OA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/457348?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/r0qs",
    "html_url": "https://github.com/r0qs",
    "followers_url": "https://api.github.com/users/r0qs/followers",
    "following_url": "https://api.github.com/users/r0qs/following{/other_user}",
    "gists_url": "https://api.github.com/users/r0qs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/r0qs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/r0qs/subscriptions",
    "organizations_url": "https://api.github.com/users/r0qs/orgs",
    "repos_url": "https://api.github.com/users/r0qs/repos",
    "events_url": "https://api.github.com/users/r0qs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/r0qs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 4438003076,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaNhA",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/medium%20effort",
      "name": "medium effort",
      "color": "ff7df7",
      "default": false,
      "description": "Default level of effort"
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "5d71ff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    },
    {
      "id": 4438481746,
      "node_id": "LA_kwDOAm_5kc8AAAABCI3bUg",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/must%20have%20eventually",
      "name": "must have eventually",
      "color": "ffb04d",
      "default": false,
      "description": "Something we consider essential but not enough to prevent us from releasing Solidity 1.0 without it."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-09-07T18:34:07Z",
  "updated_at": "2022-09-07T19:50:38Z",
  "closed_at": null,
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "## Description\r\nInvestigating issue [#13494](https://github.com/ethereum/solidity/issues/13494) I ended up in a segmentation fault error when compiling the contract below with via-IR. The contract only assigns to a variable a huge payload.\r\n\r\n## Environment\r\n\r\n- Compiler version: Version: 0.8.17-develop.2022.9.5+commit.51929652.Linux.g++ (also tested on 0.8.16 release)\r\n- Target EVM version (as per compiler settings): `via-ir`\r\n- Framework/IDE (e.g. Truffle or Remix): tested with solc and foundry\r\n- Operating system: Linux\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create a file `Test.sol` with the following code and the data payload from this example [here](https://github.com/bug-reproduction/solidity-assembly-variable-reset/blob/main/test/data/index.ts#L2)\r\n```solidity\r\npragma solidity >=0.8.16;\r\n\r\ncontract Test {\r\n\tfunction test() external {\r\n\t\tbytes memory data = hex\"615870600E600039...\"; // replace with a huge data\r\n\t}\r\n}\r\n```\r\n\r\n2. Compile the code to get the segmentation fault error\r\n```\r\nsolc --via-ir ./Test.sol\r\n```\r\n\r\nRunning using GDB returns the following stack trace on `solidity::yul::Parser::parseSrcComment`:\r\n```\r\nar const*, std::__cxx11::match_results<char const*, std::allocator<std::__cxx11::sub_match<char const*> > >&, std::__cxx11::basic_regex<char, std::__cxx11::regex_traits<char> > const&, std::regex_constants::match_flag_type, std::__detail::_RegexExecutorPolicy, bool) ()\r\n#80516 0x0000555555c4c3f4 in solidity::yul::Parser::parseSrcComment(std::basic_string_view<char, std::char_traits<char> >, solidity::langutil::SourceLocation const&) ()\r\n#80517 0x0000555555c4d63a in solidity::yul::Parser::fetchDebugDataFromComment() ()\r\n#80518 0x0000555555c4d91c in solidity::yul::Parser::advance() ()\r\n#80519 0x0000555555c50e09 in solidity::yul::Parser::parseBlock() ()\r\n#80520 0x0000555555c516e8 in solidity::yul::Parser::parseFunctionDefinition() ()\r\n#80521 0x0000555555c4ff88 in solidity::yul::Parser::parseStatement() ()\r\n#80522 0x0000555555c50e66 in solidity::yul::Parser::parseBlock() ()\r\n#80523 0x0000555555c51a83 in solidity::yul::Parser::parseInline(std::shared_ptr<solidity::langutil::Scanner> const&) ()\r\n#80524 0x0000555555c6e801 in solidity::yul::ObjectParser::parseBlock(std::optional<std::map<unsigned int, std::shared_ptr<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const>, std::less<unsigned int>, std::allocator<std::pair<unsigned int const, std::shared_ptr<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const> > > > >) ()\r\n#80525 0x0000555555c6ecaf in solidity::yul::ObjectParser::parseCode(std::optional<std::map<unsigned int, std::shared_ptr<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const>, std::less<unsigned int>, std::allocator<std::pair<unsigned int const, std::shared_ptr<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const> > > > >) ()\r\n#80526 0x0000555555c715e1 in solidity::yul::ObjectParser::parseObject(solidity::yul::Object*) ()\r\n#80527 0x0000555555c71985 in solidity::yul::ObjectParser::parseObject(solidity::yul::Object*) ()\r\n#80528 0x0000555555c71ba9 in solidity::yul::ObjectParser::parse(std::shared_ptr<solidity::langutil::Scanner> const&, bool) ()\r\n#80529 0x0000555555c5ec20 in solidity::yul::YulStack::parseAndAnalyze(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ()\r\n#80530 0x0000555555aa0e24 in solidity::frontend::IRGenerator::run[abi:cxx11](solidity::frontend::ContractDefinition const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::map<solidity::frontend::ContractDefinition const*, std::basic_string_view<char, std::char_traits<char> > const, std::less<solidity::frontend::ContractDefinition const*>, std::allocator<std::pair<solidity::frontend::ContractDefinition const* const, std::basic_string_view<char, std::char_traits<char> > const> > > const&) ()\r\n#80531 0x00005555558048d1 in solidity::frontend::CompilerStack::generateIR(solidity::frontend::ContractDefinition const&) ()\r\n#80532 0x000055555580929b in solidity::frontend::CompilerStack::compile(solidity::frontend::CompilerStack::State) ()\r\n#80533 0x0000555555735c26 in solidity::frontend::CommandLineInterface::compile() ()\r\n#80534 0x000055555573b015 in solidity::frontend::CommandLineInterface::processInput() ()\r\n#80535 0x000055555573b40c in solidity::frontend::CommandLineInterface::run(int, char const* const*) ()\r\n#80536 0x0000555555706e6c in main ()\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13496/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13496/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
