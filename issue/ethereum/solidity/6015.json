{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6015/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6015/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6015/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6015",
  "id": 410540268,
  "node_id": "MDU6SXNzdWU0MTA1NDAyNjg=",
  "number": 6015,
  "title": "Optimisation rule for replacing div/mul with shr/shl",
  "user": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1282209978,
      "node_id": "MDU6TGFiZWwxMjgyMjA5OTc4",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/optimizer",
      "name": "optimizer",
      "color": "d4c5f9",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2019-02-14T23:34:33Z",
  "updated_at": "2022-08-17T13:49:49Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "With Constantinople we have SHL/SHR opcodes and the codegen already utilises that if shift operators are being used. There is also an optimisation rule to replace shifts of constants with a constant.\r\n\r\nHowever due to a missing feature (passing EVM version) to simplification rules we do not have any to transform div/mul.\r\n\r\nThe rule should be as follows:\r\n- `div(x, y)` where y is a power of 2 can be transformed to `shr(x, log2(y))` where `log2(y)` should be precomputed of course\r\n- same with `mul(x, y)` -> `shl(x, log2(y))`\r\n\r\nThis should help to optimise code where shifts are used in inline assembly. One good example is ENS' [solsha1](https://github.com/ensdomains/solsha1).\r\n\r\n@ekpyron @chriseth any ideas how to introduce EVM version dependent rules into the simplificationrules?",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6015/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6015/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464058189",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464058189",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464058189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA1ODE4OQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T13:54:40Z",
    "updated_at": "2019-02-15T13:54:40Z",
    "author_association": "MEMBER",
    "body": "Might it make sense to just always add these rules and always translate to shifts and only to replace all shifts back to ``div`` and ``mul`` during EVM bytecode generation (at that stage we need to know the EVM version anyways)?\r\n\r\nAlso: we probably need more rules than that for the shifts? Like associativity rules and merging sequences of shifts when possible? What about mixing mul/div and shl/shr and so on?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464058189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464062216",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464062216",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464062216,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2MjIxNg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:07:45Z",
    "updated_at": "2019-02-15T14:07:45Z",
    "author_association": "MEMBER",
    "body": ">  only to replace all shifts back to `div` and `mul` during EVM bytecode generation\r\n\r\nWell currently these rules are applied *after* code generation.\r\n\r\n> Like associativity rules and merging sequences of shifts when possible?\r\n\r\nThat could be useful. Could also be added right now without any risk as long as the rules depend on `shl`/`shr` being present as that suggest the code was already compiled for constantinople.\r\n\r\n> What about mixing mul/div and shl/shr and so on?\r\n\r\nI think this also could be added without risk as long as it depends on `shl`/`shr` being present in the first place.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464062216/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065047",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464065047",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464065047,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2NTA0Nw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:16:39Z",
    "updated_at": "2019-02-15T14:16:39Z",
    "author_association": "MEMBER",
    "body": "Yes, I haven't thought that through - but the rules are not only applied after code generation, but also in the yul simplifier before code generation...\r\nBut anyways: we could still always convert to shifts and in the case of old evm versions just have another pass after running the rules that will replace all shifts with mul/div again. This would allow us to simplify code generation for shifts (we could always emit shift instructions, if they are automatically replaced at the very end for old evm versions).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065495",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464065495",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464065495,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2NTQ5NQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:18:10Z",
    "updated_at": "2019-02-15T14:18:10Z",
    "author_association": "MEMBER",
    "body": "> This would allow us to simplify code generation for shifts (we could always emit shift instructions, if they are automatically replaced at the very end for old evm versions).\r\n\r\nI think that might be a good idea. I think the rule list should be run after applying that \"final\" pass though.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065495/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065700",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464065700",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464065700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2NTcwMA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:18:46Z",
    "updated_at": "2019-02-15T14:18:46Z",
    "author_association": "MEMBER",
    "body": "More generally it might be possible to always generate byte code for the most recent evm version first and optimize that and have a dedicated pass afterwards that \"downgrades\" the generated byte code to be compatible with older EVM versions - we'd need to think about whether that's possible, though (e.g. for things like staticcall, etc.).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065700/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065955",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464065955",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464065955,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2NTk1NQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:19:34Z",
    "updated_at": "2019-02-15T14:19:34Z",
    "author_association": "MEMBER",
    "body": "> > This would allow us to simplify code generation for shifts (we could always emit shift instructions, if they are automatically replaced at the very end for old evm versions).\r\n> \r\n> I think that might be a good idea. I think the rule list should be run after applying that \"final\" pass though.\r\n\r\nI'm not sure - why would we want to run this pass before optimization and not after? Ideally the result would be the same and we wouldn't need to let the rules depend on the evm version.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464065955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464066751",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464066751",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464066751,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2Njc1MQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:22:00Z",
    "updated_at": "2019-02-15T14:22:13Z",
    "author_association": "MEMBER",
    "body": "After you have replaced a shift with multiplication for example it might be apparent that you can combine two multiplications (`mul shl` -> `mul mul` -> `mul`).\r\n\r\nAlso keep in mind that different \"evm versions\" (more like hard forks) can command different gas costs for instructions and this influences certain optimisation steps (for example the constant optimiser).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464066751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464067889",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464067889",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464067889,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2Nzg4OQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:25:20Z",
    "updated_at": "2019-02-15T14:25:20Z",
    "author_association": "MEMBER",
    "body": "The question is: might the ``mul shl``->``mul mul``->``mul`` simplification be worth it, even if we have shifts available? That probably depends on the values :-)...\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464067889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464068264",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464068264",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464068264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA2ODI2NA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:26:24Z",
    "updated_at": "2019-02-15T14:26:24Z",
    "author_association": "MEMBER",
    "body": "This is the exact question I was contemplating, but if I remember correctly the rule list does a gas calculation after an iteration to see if it is worth it. So potentially could do the mul rule even if shift is used ðŸ˜‰ ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464068264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464071416",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464071416",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464071416,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA3MTQxNg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:35:52Z",
    "updated_at": "2019-02-15T14:35:52Z",
    "author_association": "MEMBER",
    "body": "In any case, in the meantime I tend to agree that we might want to pass the EVMVersion to the rule list: even if we replace all shifts before applying the rules, we still need to disable the ``mul->shl`` rule.\r\nThe question is: what about the yul simplifier? It should probably be EVM-version-agnostic (resp. bytecode agnostic in general) - but does that mean it should do ``mul->shl`` or ``shl->mul`` :-)?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464071416/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464079869",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464079869",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464079869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDA3OTg2OQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-15T14:59:31Z",
    "updated_at": "2019-02-15T14:59:31Z",
    "author_association": "MEMBER",
    "body": "> This is the exact question I was contemplating, but if I remember correctly the rule list does a gas calculation after an iteration to see if it is worth it. So potentially could do the mul rule even if shift is used wink\r\n\r\nDoes it? Check the gas benefit I mean? I'm not too familiar with the bytecode optimizer code, but I wouldn't see where it'd do that - and it'd be tricky anyways - ``shl->mul`` would always be bad in one iteration, but might be worth it after another step doing ``mul mul->mul``... the only way to always be optimal here would probably be backtracking, wouldn't it?\r\n\r\nIf we did check the gas costs for every iteration and did backtracking, then we could just set the gas costs for shl/shr to infinite where it isn't supported and that should do it :-).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464079869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464726515",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-464726515",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 464726515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDcyNjUxNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-18T13:11:57Z",
    "updated_at": "2019-02-18T13:11:57Z",
    "author_association": "MEMBER",
    "body": "The gas calculation just counts instructions, not their cost, if I remember correctly.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/464726515/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/474672720",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-474672720",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 474672720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDY3MjcyMA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T03:41:33Z",
    "updated_at": "2019-03-20T03:41:33Z",
    "author_association": "MEMBER",
    "body": "This can be easily implemented after #6318.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/474672720/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/665218824",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-665218824",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 665218824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTIxODgyNA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-28T18:59:15Z",
    "updated_at": "2020-07-28T18:59:15Z",
    "author_association": "MEMBER",
    "body": "Hm, I actually had some local code implementing this. Will push.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/665218824/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/701992564",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-701992564",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 701992564,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTk5MjU2NA==",
    "user": {
      "login": "hrkrshnn",
      "id": 13174375,
      "node_id": "MDQ6VXNlcjEzMTc0Mzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13174375?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hrkrshnn",
      "html_url": "https://github.com/hrkrshnn",
      "followers_url": "https://api.github.com/users/hrkrshnn/followers",
      "following_url": "https://api.github.com/users/hrkrshnn/following{/other_user}",
      "gists_url": "https://api.github.com/users/hrkrshnn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hrkrshnn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hrkrshnn/subscriptions",
      "organizations_url": "https://api.github.com/users/hrkrshnn/orgs",
      "repos_url": "https://api.github.com/users/hrkrshnn/repos",
      "events_url": "https://api.github.com/users/hrkrshnn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hrkrshnn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-01T08:55:36Z",
    "updated_at": "2020-10-01T08:55:36Z",
    "author_association": "MEMBER",
    "body": "@axic Do you have a branch implementing this?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/701992564/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796640444",
    "html_url": "https://github.com/ethereum/solidity/issues/6015#issuecomment-796640444",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6015",
    "id": 796640444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjY0MDQ0NA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T10:37:53Z",
    "updated_at": "2021-03-11T10:37:59Z",
    "author_association": "MEMBER",
    "body": "https://github.com/ethereum/solidity/commit/35fe5cde06ebaec4abe2e57e366495d2c8f25b21, but now it can be implemented using the `feasible` feature with less rules (see https://github.com/ethereum/solidity/issues/6015#issuecomment-474672720)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796640444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
