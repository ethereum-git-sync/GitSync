{
  "url": "https://api.github.com/repos/flashbots/mev-boost/issues/99",
  "repository_url": "https://api.github.com/repos/flashbots/mev-boost",
  "labels_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99/labels{/name}",
  "comments_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99/comments",
  "events_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99/events",
  "html_url": "https://github.com/flashbots/mev-boost/issues/99",
  "id": 1213412844,
  "node_id": "I_kwDOGZSKs85IUzXs",
  "number": 99,
  "title": "add payment proof to relay <> mev-boost communication",
  "user": {
    "login": "metachris",
    "id": 116939,
    "node_id": "MDQ6VXNlcjExNjkzOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/116939?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/metachris",
    "html_url": "https://github.com/metachris",
    "followers_url": "https://api.github.com/users/metachris/followers",
    "following_url": "https://api.github.com/users/metachris/following{/other_user}",
    "gists_url": "https://api.github.com/users/metachris/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/metachris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/metachris/subscriptions",
    "organizations_url": "https://api.github.com/users/metachris/orgs",
    "repos_url": "https://api.github.com/users/metachris/repos",
    "events_url": "https://api.github.com/users/metachris/events{/privacy}",
    "received_events_url": "https://api.github.com/users/metachris/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4053138209,
      "node_id": "LA_kwDOGZSKs87xlfsh",
      "url": "https://api.github.com/repos/flashbots/mev-boost/labels/brainstorming",
      "name": "brainstorming",
      "color": "F198EF",
      "default": false,
      "description": "Currently in discussion"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-04-23T18:37:21Z",
  "updated_at": "2022-05-18T13:46:59Z",
  "closed_at": null,
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "On the mev-boost workshop it came up that it would be great to include the proof of payment in the getHeader response, with which the builder proves to the proposer/mev-boost that the payment has actually happened.\r\n\r\nThis could go into the initial v0.2.x (and would probably be good to have, even if we don't automatically verify it).\r\n\r\nHow would this proof work exactly?",
  "closed_by": {
    "login": "metachris",
    "id": 116939,
    "node_id": "MDQ6VXNlcjExNjkzOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/116939?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/metachris",
    "html_url": "https://github.com/metachris",
    "followers_url": "https://api.github.com/users/metachris/followers",
    "following_url": "https://api.github.com/users/metachris/following{/other_user}",
    "gists_url": "https://api.github.com/users/metachris/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/metachris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/metachris/subscriptions",
    "organizations_url": "https://api.github.com/users/metachris/orgs",
    "repos_url": "https://api.github.com/users/metachris/repos",
    "events_url": "https://api.github.com/users/metachris/events{/privacy}",
    "received_events_url": "https://api.github.com/users/metachris/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/99/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1112234652",
    "html_url": "https://github.com/flashbots/mev-boost/issues/99#issuecomment-1112234652",
    "issue_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99",
    "id": 1112234652,
    "node_id": "IC_kwDOGZSKs85CS1qc",
    "user": {
      "login": "lightclient",
      "id": 14004106,
      "node_id": "MDQ6VXNlcjE0MDA0MTA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14004106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lightclient",
      "html_url": "https://github.com/lightclient",
      "followers_url": "https://api.github.com/users/lightclient/followers",
      "following_url": "https://api.github.com/users/lightclient/following{/other_user}",
      "gists_url": "https://api.github.com/users/lightclient/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lightclient/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lightclient/subscriptions",
      "organizations_url": "https://api.github.com/users/lightclient/orgs",
      "repos_url": "https://api.github.com/users/lightclient/repos",
      "events_url": "https://api.github.com/users/lightclient/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lightclient/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-28T13:53:33Z",
    "updated_at": "2022-04-28T13:53:33Z",
    "author_association": "COLLABORATOR",
    "body": "It depends on how much information we expect the verifier to have. I see two main possibilities here:\r\n\r\n1. The verifier has no state beyond the `GetHeader` response. In this case, there needs to be two proofs. One proof against the parent root in the payload of the `feeRecipient`'s balance. The second proof against the `stateRoot` in the paylaod of the `feeRecipient`'s balance. This authenticates the balance before and after. The delta can be verified against the claimed value.\r\n2. The verifier has the previous block's state. Here, only the later proof in 1) would be needed because the balance of the `feeRecipient` before the payload is executed can be ascertained by just looking in up in the state. ",
    "reactions": {
      "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1112234652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1116003659",
    "html_url": "https://github.com/flashbots/mev-boost/issues/99#issuecomment-1116003659",
    "issue_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99",
    "id": 1116003659,
    "node_id": "IC_kwDOGZSKs85ChN1L",
    "user": {
      "login": "metachris",
      "id": 116939,
      "node_id": "MDQ6VXNlcjExNjkzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/116939?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/metachris",
      "html_url": "https://github.com/metachris",
      "followers_url": "https://api.github.com/users/metachris/followers",
      "following_url": "https://api.github.com/users/metachris/following{/other_user}",
      "gists_url": "https://api.github.com/users/metachris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/metachris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/metachris/subscriptions",
      "organizations_url": "https://api.github.com/users/metachris/orgs",
      "repos_url": "https://api.github.com/users/metachris/repos",
      "events_url": "https://api.github.com/users/metachris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/metachris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-03T11:41:46Z",
    "updated_at": "2022-05-03T11:41:46Z",
    "author_association": "COLLABORATOR",
    "body": "Closing for now, until proof of payment comes up again for the next discussions.",
    "reactions": {
      "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1116003659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1130039956",
    "html_url": "https://github.com/flashbots/mev-boost/issues/99#issuecomment-1130039956",
    "issue_url": "https://api.github.com/repos/flashbots/mev-boost/issues/99",
    "id": 1130039956,
    "node_id": "IC_kwDOGZSKs85DWwqU",
    "user": {
      "login": "thegostep",
      "id": 15959632,
      "node_id": "MDQ6VXNlcjE1OTU5NjMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/15959632?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thegostep",
      "html_url": "https://github.com/thegostep",
      "followers_url": "https://api.github.com/users/thegostep/followers",
      "following_url": "https://api.github.com/users/thegostep/following{/other_user}",
      "gists_url": "https://api.github.com/users/thegostep/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thegostep/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thegostep/subscriptions",
      "organizations_url": "https://api.github.com/users/thegostep/orgs",
      "repos_url": "https://api.github.com/users/thegostep/repos",
      "events_url": "https://api.github.com/users/thegostep/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thegostep/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-18T13:46:58Z",
    "updated_at": "2022-05-18T13:46:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Reopening this issue to discuss question raised in https://github.com/ethereum/builder-specs/issues/16\r\n\r\nMy current position on payment proofs is that it is a necessary component of the three pronged security model of mev-boost: https://hackmd.io/bTmbknkGRM6RdVCCIrRblg\r\n\r\nHere are two approaches to implementing payment proofs:\r\n1) inclusion proof on transaction trie\r\n\r\nThis approach requires the builder to set their own account as the feeRecipient address in the payloadHeader. The builder then includes a transaction at the end of the block which transfers ETH to the feeRecipient defined by the validator. Finally, the builder publishes this transaction along with the payload header and an inclusion proof.\r\n\r\n2) account proof on post execution state trie\r\n\r\nAny address can be set as the feeRecipient. Builder provides an account proof on the post execution state trie (see below).\r\n\r\nWhat are desirable properties of payment proofs?\r\n- provide transparency to the identity of builders\r\n- defense in depth, even if fraud proofs protect against invalid payments, payment proofs can be verified pre-execution thus providing stronger protection\r\n- makes accounting easier, can monitor the value of the payload bids without needing to simulate blocks\r\n\r\nWhat are potential concerns?\r\n- potential overhead of 21k gas in every block\r\n\r\n---\r\n\r\n#### AccountProof\r\n\r\nRefer to [EIP-1186](https://eips.ethereum.org/EIPS/eip-1186).\r\n\r\n- `balance`: `QUANTITY` - the balance of the account.\r\n- `nonce`: `QUANTITY`, - nonce of the account.\r\n- `storageHash`: `DATA`, 32 Bytes - SHA3 of the StorageRoot.\r\n- `codeHash`: `DATA`, 32 Bytes - hash of the code of the account. For a simple Account without code it will return \"0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470\"\r\n- `accountProof`: `ARRAY` - Array of rlp-serialized MerkleTree-Nodes, starting with the stateRoot-Node, following the path of the SHA3 (address) as key.",
    "reactions": {
      "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1130039956/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
